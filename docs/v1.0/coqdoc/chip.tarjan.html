<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="./">Project Page</a>
      <a href="./indexpage.html">Index</a>
      <a href="./toc.html">Table of Contents</a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">chip.tarjan</h1>

<div class="code">
<span class="id" title="var">From</span> <span class="id" title="var">mathcomp</span><br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">ssreflect</span> <span class="id" title="library">ssrfun</span> <span class="id" title="library">ssrbool</span> <span class="id" title="library">eqtype</span> <span class="id" title="library">ssrnat</span> <span class="id" title="library">seq</span> <span class="id" title="library">choice</span> <span class="id" title="library">fintype</span> <span class="id" title="library">tuple</span>.<br/>
<span class="id" title="var">From</span> <span class="id" title="var">mathcomp</span><br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">bigop</span> <span class="id" title="library">finset</span> <span class="id" title="library">finfun</span> <span class="id" title="library">perm</span> <span class="id" title="library">fingraph</span> <span class="id" title="library">path</span> <span class="id" title="library">div</span>.<br/>

<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>
<span class="id" title="keyword">Unset</span> <span class="id" title="keyword">Strict</span> <span class="id" title="keyword">Implicit</span>.<br/>
<span class="id" title="keyword">Unset</span> <span class="id" title="keyword">Printing</span> <span class="id" title="keyword">Implicit</span> <span class="id" title="var">Defensive</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a name="extra_div"><span class="id" title="section">extra_div</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="ltn_div2r"><span class="id" title="lemma">ltn_div2r</span></a> <span class="id" title="var">p</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> : <a class="idref" href="chip.tarjan.html#p"><span class="id" title="variable">p</span></a> <span class="id" title="notation">&gt;</span> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="notation">%/</span> <a class="idref" href="chip.tarjan.html#p"><span class="id" title="variable">p</span></a> <span class="id" title="notation">&lt;</span> <a class="idref" href="chip.tarjan.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">%/</span> <a class="idref" href="chip.tarjan.html#p"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="notation">&lt;</span> <a class="idref" href="chip.tarjan.html#n"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">p_gt0</span> <span class="id" title="var">lt_div</span>; <span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">divn_eq</span> <span class="id" title="var">m</span> <span class="id" title="var">p</span>) (<span class="id" title="lemma">divn_eq</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>).<br/>
<span class="id" title="tactic">rewrite</span> -(<span class="id" title="lemma">subnKC</span> <span class="id" title="var">lt_div</span>) <span class="id" title="lemma">mulnDl</span> <span class="id" title="lemma">mulSn</span> -!<span class="id" title="lemma">addnA</span> <span class="id" title="lemma">addnCA</span> <span class="id" title="lemma">ltn_add2l</span>.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">leq_trans</span> (<span class="id" title="lemma">ltn_pmod</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) // <span class="id" title="lemma">leq_addr</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="ltn_mod2r"><span class="id" title="lemma">ltn_mod2r</span></a> <span class="id" title="var">p</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> : <a class="idref" href="chip.tarjan.html#p"><span class="id" title="variable">p</span></a> <span class="id" title="notation">&gt;</span> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="notation">%/</span> <a class="idref" href="chip.tarjan.html#p"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">%/</span> <a class="idref" href="chip.tarjan.html#p"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="notation">%%</span> <a class="idref" href="chip.tarjan.html#p"><span class="id" title="variable">p</span></a> <span class="id" title="notation">&lt;</span> <a class="idref" href="chip.tarjan.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">%%</span> <a class="idref" href="chip.tarjan.html#p"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="notation">&lt;</span> <a class="idref" href="chip.tarjan.html#n"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">p_gt0</span> <span class="id" title="var">eq_div</span> <span class="id" title="var">lt_mod</span>; <span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">divn_eq</span> <span class="id" title="var">m</span> <span class="id" title="var">p</span>) (<span class="id" title="lemma">divn_eq</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>).<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> {}<span class="id" title="var">eq_div</span> <span class="id" title="lemma">ltn_add2l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">lt_mod</span> *.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="chip.tarjan.html#extra_div"><span class="id" title="section">extra_div</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a name="extra_seq"><span class="id" title="section">extra_seq</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="drop_subseq"><span class="id" title="lemma">drop_subseq</span></a> (<span class="id" title="var">T</span> : <span class="id" title="abbreviation">eqType</span>) <span class="id" title="var">n</span> (<span class="id" title="var">s</span> : <span class="id" title="abbreviation">seq</span> <a class="idref" href="chip.tarjan.html#T"><span class="id" title="variable">T</span></a>) : <span class="id" title="definition">subseq</span> (<span class="id" title="definition">drop</span> <a class="idref" href="chip.tarjan.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a>) <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> -[<span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="definition">subseq</span> <span class="id" title="var">_</span> <a class="idref" href="chip.tarjan.html#X"><span class="id" title="variable">X</span></a>](<span class="id" title="lemma">cat_take_drop</span> <span class="id" title="var">n</span>) <span class="id" title="lemma">suffix_subseq</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="uniq_catLR"><span class="id" title="lemma">uniq_catLR</span></a> (<span class="id" title="var">T</span> : <span class="id" title="abbreviation">eqType</span>) (<span class="id" title="var">x</span> : <a class="idref" href="chip.tarjan.html#T"><span class="id" title="variable">T</span></a>) <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> : <span class="id" title="definition">uniq</span> (<a class="idref" href="chip.tarjan.html#s1"><span class="id" title="variable">s1</span></a> <span class="id" title="notation">++</span> <a class="idref" href="chip.tarjan.html#s2"><span class="id" title="variable">s2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#s1"><span class="id" title="variable">s1</span></a> <span class="id" title="notation">++</span> <a class="idref" href="chip.tarjan.html#s2"><span class="id" title="variable">s2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#s1"><span class="id" title="variable">s1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">notin</span></a> <a class="idref" href="chip.tarjan.html#s2"><span class="id" title="variable">s2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mem_cat</span>=&gt; <span class="id" title="var">s_uniq</span> /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orP"><span class="id" title="lemma">orP</span></a>[] <span class="id" title="var">x_in</span>; <span class="id" title="tactic">move</span>: <span class="id" title="var">s_uniq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">uniq_catC</span> <span class="id" title="lemma">cat_uniq</span> =&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#and3P"><span class="id" title="lemma">and3P</span></a>[<span class="id" title="var">_</span> /<span class="id" title="lemma">hasPn</span> /(<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">x_in</span>)-&gt;].<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">cat_uniq</span> =&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#and3P"><span class="id" title="lemma">and3P</span></a>[<span class="id" title="var">_</span> /<span class="id" title="lemma">hasPn</span> /(<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">x_in</span>) /= /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#negPf"><span class="id" title="lemma">negPf</span></a>-&gt;]; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">x_in</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="uniq_catRL"><span class="id" title="lemma">uniq_catRL</span></a> (<span class="id" title="var">T</span> : <span class="id" title="abbreviation">eqType</span>) (<span class="id" title="var">x</span> : <a class="idref" href="chip.tarjan.html#T"><span class="id" title="variable">T</span></a>) <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> : <span class="id" title="definition">uniq</span> (<a class="idref" href="chip.tarjan.html#s1"><span class="id" title="variable">s1</span></a> <span class="id" title="notation">++</span> <a class="idref" href="chip.tarjan.html#s2"><span class="id" title="variable">s2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#s1"><span class="id" title="variable">s1</span></a> <span class="id" title="notation">++</span> <a class="idref" href="chip.tarjan.html#s2"><span class="id" title="variable">s2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="definition">uniq</span> (<a class="idref" href="chip.tarjan.html#s1"><span class="id" title="variable">s1</span></a> <span class="id" title="notation">++</span> <a class="idref" href="chip.tarjan.html#s2"><span class="id" title="variable">s2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#s2"><span class="id" title="variable">s2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">notin</span></a> <a class="idref" href="chip.tarjan.html#s1"><span class="id" title="variable">s1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mem_cat</span> <span class="id" title="lemma">uniq_catC</span> =&gt; <span class="id" title="var">s_uniq</span> <span class="id" title="var">x_s</span>.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (<a class="idref" href="chip.tarjan.html#uniq_catLR"><span class="id" title="lemma">uniq_catLR</span></a> <span class="id" title="var">s_uniq</span>) // <span class="id" title="lemma">mem_cat</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbC"><span class="id" title="lemma">orbC</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="chip.tarjan.html#extra_seq"><span class="id" title="section">extra_seq</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a name="extra_finset"><span class="id" title="section">extra_finset</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="subset_bigcup"><span class="id" title="lemma">subset_bigcup</span></a> (<span class="id" title="var">T</span>: <span class="id" title="abbreviation">finType</span>) (<span class="id" title="var">sccs</span> <span class="id" title="var">sccs'</span> : <span class="id" title="notation">{</span><span class="id" title="notation">set</span> <span class="id" title="notation">{</span><span class="id" title="notation">set</span> <a class="idref" href="chip.tarjan.html#T"><span class="id" title="variable">T</span></a><span class="id" title="notation">}}</span>) :<br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#sccs"><span class="id" title="variable">sccs</span></a> <span class="id" title="notation">\</span><span class="id" title="notation">subset</span> <a class="idref" href="chip.tarjan.html#sccs'"><span class="id" title="variable">sccs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="definition">cover</span> <a class="idref" href="chip.tarjan.html#sccs"><span class="id" title="variable">sccs</span></a> <span class="id" title="notation">\</span><span class="id" title="notation">subset</span> <span class="id" title="definition">cover</span> <a class="idref" href="chip.tarjan.html#sccs'"><span class="id" title="variable">sccs'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; /<span class="id" title="lemma">subsetP</span> <span class="id" title="var">subsccs</span>; <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">subsetP</span>=&gt; <span class="id" title="var">x</span> /<span class="id" title="lemma">bigcupP</span> [<span class="id" title="var">scc</span> /<span class="id" title="var">subsccs</span>].<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">scc'</span> <span class="id" title="var">x_in</span>; <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">bigcupP</span>; <span class="id" title="tactic">exists</span> <span class="id" title="var">scc</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="chip.tarjan.html#extra_finset"><span class="id" title="section">extra_finset</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a name="tarjan"><span class="id" title="section">tarjan</span></a>.<br/>

<br/>
<span class="id" title="keyword">Variable</span> (<a name="tarjan.V"><span class="id" title="variable">V</span></a> : <span class="id" title="abbreviation">finType</span>) (<a name="tarjan.successors"><span class="id" title="variable">successors</span></a> : <a class="idref" href="chip.tarjan.html#V"><span class="id" title="variable">V</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">seq</span> <a class="idref" href="chip.tarjan.html#V"><span class="id" title="variable">V</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a name="edge"><span class="id" title="abbreviation">edge</span></a> := (<span class="id" title="definition">grel</span> <a class="idref" href="chip.tarjan.html#tarjan.successors"><span class="id" title="variable">successors</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a name="gconnect"><span class="id" title="abbreviation">gconnect</span></a> := (<span class="id" title="definition">connect</span> <a class="idref" href="chip.tarjan.html#edge"><span class="id" title="abbreviation">edge</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a name="infty"><span class="id" title="abbreviation">infty</span></a> := <span class="id" title="notation">#|</span><a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">|</span>.<br/>

<br/>
<span class="comment">(*************************************************)</span><br/>
<span class="comment">(*&nbsp;Connected&nbsp;components&nbsp;of&nbsp;the&nbsp;graph,&nbsp;abstractly&nbsp;*)</span><br/>
<span class="comment">(*************************************************)</span><br/>

<br/>
<span class="id" title="keyword">Notation</span> <a name="gbiconnect"><span class="id" title="abbreviation">gbiconnect</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#fea9f4d81fed4d4bd9309c8e510110f0"><span class="id" title="notation">[</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#fea9f4d81fed4d4bd9309c8e510110f0"><span class="id" title="notation">rel</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#fea9f4d81fed4d4bd9309c8e510110f0"><span class="id" title="notation">|</span></a> <a class="idref" href="chip.tarjan.html#gconnect"><span class="id" title="abbreviation">gconnect</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="chip.tarjan.html#gconnect"><span class="id" title="abbreviation">gconnect</span></a> <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#fea9f4d81fed4d4bd9309c8e510110f0"><span class="id" title="notation">]</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="gbiconnect_equiv"><span class="id" title="lemma">gbiconnect_equiv</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#equivalence_rel"><span class="id" title="definition">equivalence_rel</span></a> <a class="idref" href="chip.tarjan.html#gbiconnect"><span class="id" title="abbreviation">gbiconnect</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">split</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> /<a class="idref" href="chip.tarjan.html#gbiconnect"><span class="id" title="abbreviation">gbiconnect</span></a> /= <span class="id" title="lemma">connect0</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> [<span class="id" title="var">xy</span> <span class="id" title="var">yx</span>]; <span class="id" title="tactic">rewrite</span> /<a class="idref" href="chip.tarjan.html#gbiconnect"><span class="id" title="abbreviation">gbiconnect</span></a> /=.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>/<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#idP"><span class="id" title="lemma">idP</span></a>/<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#idP"><span class="id" title="lemma">idP</span></a> =&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> [/(<span class="id" title="lemma">connect_trans</span> <span class="id" title="var">_</span>)-&gt; // /<span class="id" title="lemma">connect_trans</span>-&gt;].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="gsccs"><span class="id" title="definition">gsccs</span></a> := <span class="id" title="definition">equivalence_partition</span> <a class="idref" href="chip.tarjan.html#gbiconnect"><span class="id" title="abbreviation">gbiconnect</span></a> <span class="id" title="abbreviation">setT</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="gsccs_partition"><span class="id" title="lemma">gsccs_partition</span></a> : <span class="id" title="definition">partition</span> <a class="idref" href="chip.tarjan.html#gsccs"><span class="id" title="definition">gsccs</span></a> <span class="id" title="abbreviation">setT</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>: <span class="id" title="lemma">equivalence_partitionP</span> =&gt; ?*; <span class="id" title="tactic">apply</span>: <a class="idref" href="chip.tarjan.html#gbiconnect_equiv"><span class="id" title="lemma">gbiconnect_equiv</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="cover_gsccs"><span class="id" title="definition">cover_gsccs</span></a> := <span class="id" title="lemma">cover_partition</span> <a class="idref" href="chip.tarjan.html#gsccs_partition"><span class="id" title="lemma">gsccs_partition</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="trivIset_gsccs"><span class="id" title="lemma">trivIset_gsccs</span></a> : <span class="id" title="definition">trivIset</span> <a class="idref" href="chip.tarjan.html#gsccs"><span class="id" title="definition">gsccs</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">case</span>/<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#and3P"><span class="id" title="lemma">and3P</span></a>: <a class="idref" href="chip.tarjan.html#gsccs_partition"><span class="id" title="lemma">gsccs_partition</span></a>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">trivIset_gsccs</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a name="scc_of"><span class="id" title="abbreviation">scc_of</span></a> := (<span class="id" title="definition">pblock</span> <a class="idref" href="chip.tarjan.html#gsccs"><span class="id" title="definition">gsccs</span></a>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="mem_scc"><span class="id" title="lemma">mem_scc</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#scc_of"><span class="id" title="abbreviation">scc_of</span></a> <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#gbiconnect"><span class="id" title="abbreviation">gbiconnect</span></a> <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">pblock_equivalence_partition</span> // =&gt; ?*; <span class="id" title="tactic">apply</span>: <a class="idref" href="chip.tarjan.html#gbiconnect_equiv"><span class="id" title="lemma">gbiconnect_equiv</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="def_scc"><span class="id" title="definition">def_scc</span></a> <span class="id" title="var">scc</span> <span class="id" title="var">x</span> := @<span class="id" title="lemma">def_pblock</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="chip.tarjan.html#scc"><span class="id" title="variable">scc</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#trivIset_gsccs"><span class="id" title="lemma">trivIset_gsccs</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="is_subscc"><span class="id" title="definition">is_subscc</span></a> (<span class="id" title="var">A</span> : <span class="id" title="notation">{</span><span class="id" title="notation">set</span> <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">}</span>) := <a class="idref" href="chip.tarjan.html#A"><span class="id" title="variable">A</span></a> <span class="id" title="notation">!=</span> <span class="id" title="definition">set0</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b4f176550f5b849a7fbba2ee164934d3"><span class="id" title="notation">{</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b4f176550f5b849a7fbba2ee164934d3"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b4f176550f5b849a7fbba2ee164934d3"><span class="id" title="notation">&amp;,</span></a> <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <a class="idref" href="chip.tarjan.html#gconnect"><span class="id" title="abbreviation">gconnect</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b4f176550f5b849a7fbba2ee164934d3"><span class="id" title="notation">}</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_subscc_in_scc"><span class="id" title="lemma">is_subscc_in_scc</span></a> (<span class="id" title="var">A</span> : <span class="id" title="notation">{</span><span class="id" title="notation">set</span> <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">}</span>) :<br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#is_subscc"><span class="id" title="definition">is_subscc</span></a> <a class="idref" href="chip.tarjan.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#3df228c109f14f0423b4fccc967ee1ac"><span class="id" title="notation">exists2</span></a> <span class="id" title="var">scc</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#3df228c109f14f0423b4fccc967ee1ac"><span class="id" title="notation">,</span></a> <a class="idref" href="chip.tarjan.html#scc"><span class="id" title="variable">scc</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#gsccs"><span class="id" title="definition">gsccs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#3df228c109f14f0423b4fccc967ee1ac"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="chip.tarjan.html#A"><span class="id" title="variable">A</span></a> <span class="id" title="notation">\</span><span class="id" title="notation">subset</span> <a class="idref" href="chip.tarjan.html#scc"><span class="id" title="variable">scc</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; []; <span class="id" title="var">have</span> [-&gt;|[<span class="id" title="var">x</span> <span class="id" title="var">xA</span>]] := <span class="id" title="lemma">set_0Vmem</span> <span class="id" title="var">A</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="abbreviation">eqxx</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">AN0</span> <span class="id" title="var">A_sub</span>; <span class="id" title="tactic">exists</span> (<a class="idref" href="chip.tarjan.html#scc_of"><span class="id" title="abbreviation">scc_of</span></a> <span class="id" title="var">x</span>); <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">pblock_mem</span> ?<a class="idref" href="chip.tarjan.html#cover_gsccs"><span class="id" title="definition">cover_gsccs</span></a>.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">subsetP</span> =&gt; <span class="id" title="var">y</span> <span class="id" title="var">yA</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#mem_scc"><span class="id" title="lemma">mem_scc</span></a> /= !<span class="id" title="var">A_sub</span> //.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="is_subscc1"><span class="id" title="lemma">is_subscc1</span></a> <span class="id" title="var">x</span> (<span class="id" title="var">A</span> : <span class="id" title="notation">{</span><span class="id" title="notation">set</span> <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">}</span>) : <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">y</span>, <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#gconnect"><span class="id" title="abbreviation">gconnect</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="chip.tarjan.html#gconnect"><span class="id" title="abbreviation">gconnect</span></a> <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#is_subscc"><span class="id" title="definition">is_subscc</span></a> <a class="idref" href="chip.tarjan.html#A"><span class="id" title="variable">A</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">xA</span> <span class="id" title="var">AP</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>: <span class="id" title="lemma">contraTneq</span> <span class="id" title="var">xA</span> =&gt; -&gt;; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span>.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y</span> <span class="id" title="var">z</span> /<span class="id" title="var">AP</span> [<span class="id" title="var">xy</span> <span class="id" title="var">yx</span>] /<span class="id" title="var">AP</span> [<span class="id" title="var">xz</span> <span class="id" title="var">zx</span>]; <span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">connect_trans</span> <span class="id" title="var">yx</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(**********************************************************)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Tarjan&nbsp;72&nbsp;algorithm,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;rewritten&nbsp;in&nbsp;a&nbsp;functional&nbsp;style&nbsp;by&nbsp;JJ&nbsp;Levy&nbsp;&amp;&nbsp;Ran&nbsp;Chen&nbsp;&nbsp;*)</span><br/>
<span class="comment">(**********************************************************)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="split_after"><span class="id" title="definition">split_after</span></a> (<span class="id" title="var">T</span> :<span class="id" title="abbreviation">eqType</span>) (<span class="id" title="var">x</span> : <a class="idref" href="chip.tarjan.html#T"><span class="id" title="variable">T</span></a>) (<span class="id" title="var">s</span> : <span class="id" title="abbreviation">seq</span> <a class="idref" href="chip.tarjan.html#T"><span class="id" title="variable">T</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">i</span> := <span class="id" title="definition">index</span> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <span class="id" title="tactic">in</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="definition">rcons</span> (<span class="id" title="definition">take</span> <a class="idref" href="chip.tarjan.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a>) <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="definition">drop</span> <a class="idref" href="chip.tarjan.html#i"><span class="id" title="variable">i</span></a><span class="id" title="notation">.+1</span> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="rank"><span class="id" title="definition">rank</span></a> (<span class="id" title="var">x</span> : <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a>) <span class="id" title="var">stack</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="variable">stack</span></a> <span class="id" title="var">isn't</span> <span class="id" title="var">y</span> <span class="id" title="notation">::</span> <span class="id" title="var">s</span> <span class="id" title="keyword">then</span> <a class="idref" href="chip.tarjan.html#infty"><span class="id" title="abbreviation">infty</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">if</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="notation">==</span> <span class="id" title="var">y</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">notin</span></a> <span class="id" title="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">then</span></a> <span class="id" title="definition">size</span> <span class="id" title="var">s</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">else</span></a> <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">s</span>.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a name="env"><span class="id" title="record">env</span></a> := <a name="Env"><span class="id" title="constructor">Env</span></a> {<a name="blacks"><span class="id" title="projection">blacks</span></a> : <span class="id" title="notation">{</span><span class="id" title="notation">set</span> <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">}</span>; <a name="stack"><span class="id" title="projection">stack</span></a> : <span class="id" title="abbreviation">seq</span> <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a>; <a name="sccs"><span class="id" title="projection">sccs</span></a> : <span class="id" title="notation">{</span><span class="id" title="notation">set</span> <span class="id" title="notation">{</span><span class="id" title="notation">set</span> <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">}}</span>}.<br/>
<span class="id" title="keyword">Definition</span> <a name="grays"><span class="id" title="definition">grays</span></a> (<span class="id" title="var">e</span> : <a class="idref" href="chip.tarjan.html#env"><span class="id" title="record">env</span></a>) := <span class="id" title="notation">[</span><span class="id" title="notation">set</span> <span class="id" title="var">x</span> <span class="id" title="notation">in</span> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a><span class="id" title="notation">]</span> <span class="id" title="notation">:\:</span> <a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a name="whites"><span class="id" title="definition">whites</span></a> (<span class="id" title="var">e</span> : <a class="idref" href="chip.tarjan.html#env"><span class="id" title="record">env</span></a>) := <span class="id" title="notation">~:</span> <span class="id" title="notation">(</span><a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <span class="id" title="notation">:|:</span> <a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a><span class="id" title="notation">)</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="add_stack"><span class="id" title="definition">add_stack</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span> := <a class="idref" href="chip.tarjan.html#Env"><span class="id" title="constructor">Env</span></a> (<a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) (<a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="notation">::</span> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) (<a class="idref" href="chip.tarjan.html#sccs"><span class="id" title="projection">sccs</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>).<br/>
<span class="id" title="keyword">Definition</span> <a name="add_blacks"><span class="id" title="definition">add_blacks</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span> := <a class="idref" href="chip.tarjan.html#Env"><span class="id" title="constructor">Env</span></a> (<a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="notation">|:</span> <a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) (<a class="idref" href="chip.tarjan.html#sccs"><span class="id" title="projection">sccs</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>).<br/>
<span class="id" title="keyword">Definition</span> <a name="add_sccs"><span class="id" title="definition">add_sccs</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span> := <span class="id" title="keyword">let</span> (<span class="id" title="var">s2</span>, <span class="id" title="var">s3</span>) := <a class="idref" href="chip.tarjan.html#split_after"><span class="id" title="definition">split_after</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#Env"><span class="id" title="constructor">Env</span></a> (<a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="notation">|:</span> <a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="chip.tarjan.html#s3"><span class="id" title="variable">s3</span></a> (<span class="id" title="notation">[</span><span class="id" title="notation">set</span> <span class="id" title="var">y</span> <span class="id" title="notation">in</span> <a class="idref" href="chip.tarjan.html#s2"><span class="id" title="variable">s2</span></a><span class="id" title="notation">]</span> <span class="id" title="notation">|:</span> <a class="idref" href="chip.tarjan.html#sccs"><span class="id" title="projection">sccs</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="dfs1"><span class="id" title="definition">dfs1</span></a> (<span class="id" title="var">dfs'</span> : <span class="id" title="notation">{</span><span class="id" title="notation">set</span> <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">}</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#env"><span class="id" title="record">env</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="chip.tarjan.html#env"><span class="id" title="record">env</span></a>) (<span class="id" title="var">x</span> : <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a>) <span class="id" title="var">e</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m</span> := <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="notation">::</span> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">m1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">e1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> := <a class="idref" href="chip.tarjan.html#dfs'"><span class="id" title="variable">dfs'</span></a> <span class="id" title="notation">[</span><span class="id" title="notation">set</span> <span class="id" title="var">y</span> <span class="id" title="notation">in</span> <a class="idref" href="chip.tarjan.html#tarjan.successors"><span class="id" title="variable">successors</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a><span class="id" title="notation">]</span> (<a class="idref" href="chip.tarjan.html#add_stack"><span class="id" title="definition">add_stack</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">if</span></a> <span class="id" title="var">m1</span> <span class="id" title="notation">&gt;=</span> <a class="idref" href="chip.tarjan.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">then</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#infty"><span class="id" title="abbreviation">infty</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="chip.tarjan.html#add_sccs"><span class="id" title="definition">add_sccs</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">e1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">else</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">m1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="chip.tarjan.html#add_blacks"><span class="id" title="definition">add_blacks</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">e1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="dfs'"><span class="id" title="definition">dfs'</span></a> <span class="id" title="var">dfs1</span> <span class="id" title="var">dfs'</span> (<span class="id" title="var">roots</span> : <span class="id" title="notation">{</span><span class="id" title="notation">set</span> <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">}</span>) <span class="id" title="var">e</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="notation">[</span><span class="id" title="notation">pick</span> <span class="id" title="var">x</span> <span class="id" title="notation">in</span> <a class="idref" href="chip.tarjan.html#roots"><span class="id" title="variable">roots</span></a><span class="id" title="notation">]</span> <span class="id" title="var">isn't</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">x</span> <span class="id" title="keyword">then</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#infty"><span class="id" title="abbreviation">infty</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">let</span> <span class="id" title="var">roots'</span> := <a class="idref" href="chip.tarjan.html#roots"><span class="id" title="variable">roots</span></a> <span class="id" title="notation">:\</span> <span class="id" title="var">x</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">m1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">e1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">if</span></a> <span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">then</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <span class="id" title="var">x</span> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">else</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">if</span></a> <span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">then</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#infty"><span class="id" title="abbreviation">infty</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">else</span></a> <a class="idref" href="chip.tarjan.html#dfs1"><span class="id" title="variable">dfs1</span></a> <span class="id" title="var">x</span> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">m2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">e2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> := <a class="idref" href="chip.tarjan.html#dfs'"><span class="id" title="variable">dfs'</span></a> <a class="idref" href="chip.tarjan.html#roots'"><span class="id" title="variable">roots'</span></a> <span class="id" title="var">e1</span> <span class="id" title="tactic">in</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="definition">minn</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">e2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="tarjan_rec"><span class="id" title="definition">tarjan_rec</span></a> <span class="id" title="var">n</span> : <span class="id" title="notation">{</span><span class="id" title="notation">set</span> <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">}</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#env"><span class="id" title="record">env</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="chip.tarjan.html#env"><span class="id" title="record">env</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="chip.tarjan.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">is</span> <span class="id" title="var">n</span><span class="id" title="notation">.+1</span> <span class="id" title="keyword">then</span> <a class="idref" href="chip.tarjan.html#dfs'"><span class="id" title="definition">dfs'</span></a> (<a class="idref" href="chip.tarjan.html#dfs1"><span class="id" title="definition">dfs1</span></a> (<a class="idref" href="chip.tarjan.html#tarjan_rec"><span class="id" title="definition">tarjan_rec</span></a> <a class="idref" href="chip.tarjan.html#n"><span class="id" title="variable">n</span></a>)) (<a class="idref" href="chip.tarjan.html#tarjan_rec"><span class="id" title="definition">tarjan_rec</span></a> <a class="idref" href="chip.tarjan.html#n"><span class="id" title="variable">n</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">fun</span> <span class="id" title="var">r</span> <span class="id" title="var">e</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#infty"><span class="id" title="abbreviation">infty</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Let</span> <a name="tarjan.N"><span class="id" title="variable">N</span></a> := <span class="id" title="notation">#|</span><a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">|</span> <span class="id" title="notation">*</span> <span class="id" title="notation">#|</span><a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">|</span><span class="id" title="notation">.+1</span> <span class="id" title="notation">+</span> <span class="id" title="notation">#|</span><a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">|</span>.<br/>
<span class="id" title="keyword">Definition</span> <a name="e0"><span class="id" title="definition">e0</span></a> := (<a class="idref" href="chip.tarjan.html#Env"><span class="id" title="constructor">Env</span></a> <span class="id" title="definition">set0</span> <span class="id" title="notation">[::]</span> <span class="id" title="definition">set0</span>).<br/>
<span class="id" title="keyword">Definition</span> <a name="tarjan"><span class="id" title="definition">tarjan</span></a> := <a class="idref" href="chip.tarjan.html#sccs"><span class="id" title="projection">sccs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrfun.html#675082cc4d4538da052b547bdc6ea4c9"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#tarjan_rec"><span class="id" title="definition">tarjan_rec</span></a> <a class="idref" href="chip.tarjan.html#tarjan.N"><span class="id" title="variable">N</span></a> <span class="id" title="abbreviation">setT</span> <a class="idref" href="chip.tarjan.html#e0"><span class="id" title="definition">e0</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrfun.html#675082cc4d4538da052b547bdc6ea4c9"><span class="id" title="notation">).2</span></a>.<br/>

<br/>
<span class="comment">(**************************************************************)</span><br/>
<span class="comment">(*&nbsp;Well&nbsp;formed&nbsp;environements&nbsp;and&nbsp;operations&nbsp;on&nbsp;environements.&nbsp;*)</span><br/>
<span class="comment">(**************************************************************)</span><br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="wf_env"><span class="id" title="record">wf_env</span></a> <span class="id" title="var">e</span> := <a name="WfEnv"><span class="id" title="constructor">WfEnv</span></a> {<br/>
&nbsp;&nbsp;&nbsp;<a name="wf_stack"><span class="id" title="projection">wf_stack</span></a> : <span class="id" title="notation">[</span><span class="id" title="notation">set</span> <span class="id" title="var">x</span> <span class="id" title="notation">in</span> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a><span class="id" title="notation">]</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <span class="id" title="notation">:|:</span> <span class="id" title="notation">(</span><a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <span class="id" title="notation">:\:</span> <span class="id" title="definition">cover</span> (<a class="idref" href="chip.tarjan.html#sccs"><span class="id" title="projection">sccs</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>)<span class="id" title="notation">)</span>;<br/>
&nbsp;&nbsp;&nbsp;<a name="wf_sccs"><span class="id" title="projection">wf_sccs</span></a> : <span class="id" title="definition">cover</span> (<a class="idref" href="chip.tarjan.html#sccs"><span class="id" title="projection">sccs</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <span class="id" title="notation">\</span><span class="id" title="notation">subset</span> <a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>;<br/>
&nbsp;&nbsp;&nbsp;<a name="wf_stack_uniq"><span class="id" title="projection">wf_stack_uniq</span></a> : <span class="id" title="definition">uniq</span> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>)<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="color_spec"><span class="id" title="inductive">color_spec</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Type</span> :=<br/>
| <a name="ColorGray"><span class="id" title="constructor">ColorGray</span></a> <span class="id" title="keyword">of</span> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> : <a class="idref" href="chip.tarjan.html#color_spec"><span class="id" title="inductive">color_spec</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
| <a name="ColorSccs"><span class="id" title="constructor">ColorSccs</span></a> <span class="id" title="keyword">of</span> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="definition">cover</span> (<a class="idref" href="chip.tarjan.html#sccs"><span class="id" title="projection">sccs</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#color_spec"><span class="id" title="inductive">color_spec</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
| <a name="ColorWhite"><span class="id" title="constructor">ColorWhite</span></a> <span class="id" title="keyword">of</span> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> : <a class="idref" href="chip.tarjan.html#color_spec"><span class="id" title="inductive">color_spec</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
| <a name="ColorBlackStack"><span class="id" title="constructor">ColorBlackStack</span></a> <span class="id" title="keyword">of</span> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> &amp; <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#color_spec"><span class="id" title="inductive">color_spec</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="colorP"><span class="id" title="lemma">colorP</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span> : <a class="idref" href="chip.tarjan.html#wf_env"><span class="id" title="record">wf_env</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#color_spec"><span class="id" title="inductive">color_spec</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> (<a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) (<a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="definition">cover</span> (<a class="idref" href="chip.tarjan.html#sccs"><span class="id" title="projection">sccs</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) (<a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; [/<span class="id" title="lemma">setP</span> /(<span class="id" title="var">_</span> <span class="id" title="var">x</span>) <span class="id" title="var">s_def</span>] /<span class="id" title="lemma">subsetP</span> /(<span class="id" title="var">_</span> <span class="id" title="var">x</span>) /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#implyP"><span class="id" title="lemma">implyP</span></a>.<br/>
<span class="id" title="tactic">move</span>: <span class="id" title="var">s_def</span>; <span class="id" title="tactic">rewrite</span> /<a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> /<a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> !<span class="id" title="definition">inE</span>.<br/>
<span class="id" title="tactic">case</span> <span class="id" title="var">x_black</span>: (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <span class="id" title="var">_</span>) =&gt; /=;<br/>
<span class="id" title="tactic">case</span> <span class="id" title="var">x_stack</span> : (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">_</span>) =&gt; /=;<br/>
<span class="id" title="tactic">case</span> <span class="id" title="var">x_sccs</span> : (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="definition">cover</span> <span class="id" title="var">_</span>) =&gt; //=; <span class="id" title="tactic">do</span> ?<span class="id" title="tactic">by</span> <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">constructor</span>=&gt; //; <span class="id" title="tactic">rewrite</span> /<a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> !<span class="id" title="definition">inE</span> <span class="id" title="var">x_black</span>.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">rewrite</span> /<a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> !<span class="id" title="definition">inE</span> <span class="id" title="var">x_black</span> <span class="id" title="var">x_stack</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="grays0"><span class="id" title="lemma">grays0</span></a> : <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <a class="idref" href="chip.tarjan.html#e0"><span class="id" title="definition">e0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">set0</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">setP</span>=&gt; <span class="id" title="var">x</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> /=. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="cover0"><span class="id" title="lemma">cover0</span></a> : <span class="id" title="definition">cover</span> <span class="id" title="definition">set0</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf"><span class="id" title="notation">=</span></a> <span class="id" title="definition">set0</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf"><span class="id" title="notation">:&gt;</span></a> <span class="id" title="notation">{</span><span class="id" title="notation">set</span> <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">}</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">setP</span>=&gt; <span class="id" title="var">x</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span>; <span class="id" title="tactic">apply</span>/<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#negP"><span class="id" title="lemma">negP</span></a>=&gt; /<span class="id" title="lemma">bigcupP</span>[?]; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="whites_blacksF"><span class="id" title="lemma">whites_blacksF</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span> : <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span>; <span class="id" title="tactic">case</span>: (<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <span class="id" title="var">_</span>). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="whites_stackF"><span class="id" title="lemma">whites_stackF</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span> : <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andbC"><span class="id" title="lemma">andbC</span></a>; <span class="id" title="tactic">case</span>: (<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">_</span>); <span class="id" title="tactic">rewrite</span> //= <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orNb"><span class="id" title="lemma">orNb</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="whites_graysF"><span class="id" title="lemma">whites_graysF</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span> : <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andbC"><span class="id" title="lemma">andbC</span></a>; <span class="id" title="tactic">case</span>: (<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">_</span>); <span class="id" title="tactic">rewrite</span> //= <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orNb"><span class="id" title="lemma">orNb</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="grays_stack"><span class="id" title="lemma">grays_stack</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span> : <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andbC"><span class="id" title="lemma">andbC</span></a>; <span class="id" title="tactic">case</span>: (<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">_</span>). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="grays_sccsF"><span class="id" title="lemma">grays_sccsF</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span> : <a class="idref" href="chip.tarjan.html#wf_env"><span class="id" title="record">wf_env</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="definition">cover</span> (<a class="idref" href="chip.tarjan.html#sccs"><span class="id" title="projection">sccs</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">case</span>/<a class="idref" href="chip.tarjan.html#colorP"><span class="id" title="lemma">colorP</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="sccs_stackF"><span class="id" title="lemma">sccs_stackF</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span> : <a class="idref" href="chip.tarjan.html#wf_env"><span class="id" title="record">wf_env</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="definition">cover</span> (<a class="idref" href="chip.tarjan.html#sccs"><span class="id" title="projection">sccs</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">case</span>/<a class="idref" href="chip.tarjan.html#colorP"><span class="id" title="lemma">colorP</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="whites_add_stack"><span class="id" title="lemma">whites_add_stack</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span> : <a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> (<a class="idref" href="chip.tarjan.html#add_stack"><span class="id" title="definition">add_stack</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <span class="id" title="notation">:\</span> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">setP</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> /=.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">case</span>: (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="var">_</span>) (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="var">_</span>) (<span class="id" title="var">_</span> <span class="id" title="notation">==</span> <span class="id" title="var">_</span>) =&gt; [] [] [].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="grays_add_stack"><span class="id" title="lemma">grays_add_stack</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span> : <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> (<a class="idref" href="chip.tarjan.html#add_stack"><span class="id" title="definition">add_stack</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="notation">|:</span> <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">x_whites</span>; <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">setP</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">move</span>: <span class="id" title="var">x_whites</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span>.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">case</span>: <span class="id" title="lemma">eqP</span> =&gt; [-&gt;|]; <span class="id" title="tactic">case</span>: (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="var">_</span>) (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="var">_</span>)=&gt; [] [].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="stack_add_stack"><span class="id" title="lemma">stack_add_stack</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span> : <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> (<a class="idref" href="chip.tarjan.html#add_stack"><span class="id" title="definition">add_stack</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="notation">::</span> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> []. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="add_stack_ewf"><span class="id" title="lemma">add_stack_ewf</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span> : <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#wf_env"><span class="id" title="record">wf_env</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#wf_env"><span class="id" title="record">wf_env</span></a> (<a class="idref" href="chip.tarjan.html#add_stack"><span class="id" title="definition">add_stack</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">x_white</span> [<span class="id" title="var">s_def</span> <span class="id" title="var">sccs_blacks</span> <span class="id" title="var">s_uniq</span>]; <span class="id" title="tactic">split</span> =&gt; //=;<br/>
&nbsp;&nbsp;<span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#whites_stackF"><span class="id" title="lemma">whites_stackF</span></a>.<br/>
<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">setP</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span>.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="var">have</span> [-&gt;|] := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#altP"><span class="id" title="lemma">altP</span></a> (<span class="id" title="var">y</span> <span class="id" title="notation">=</span><span class="id" title="notation">P</span> <span class="id" title="var">x</span>); <span class="id" title="tactic">case</span>: <a class="idref" href="chip.tarjan.html#colorP"><span class="id" title="lemma">colorP</span></a>=&gt; //=; <span class="id" title="tactic">case</span>: <a class="idref" href="chip.tarjan.html#colorP"><span class="id" title="lemma">colorP</span></a> <span class="id" title="var">x_white</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="add_blacks_ewf"><span class="id" title="lemma">add_blacks_ewf</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span> : <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#wf_env"><span class="id" title="record">wf_env</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#wf_env"><span class="id" title="record">wf_env</span></a> (<a class="idref" href="chip.tarjan.html#add_blacks"><span class="id" title="definition">add_blacks</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">x_gray</span> [<span class="id" title="var">s_def</span> <span class="id" title="var">sccs_blacks</span> <span class="id" title="var">s_uniq</span>]; <span class="id" title="tactic">split</span> =&gt; //=; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">subsetU</span> // <span class="id" title="var">sccs_blacks</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbT"><span class="id" title="lemma">orbT</span></a>.<br/>
<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">setP</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span>.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="var">have</span> [-&gt;|] := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#altP"><span class="id" title="lemma">altP</span></a> (<span class="id" title="var">y</span> <span class="id" title="notation">=</span><span class="id" title="notation">P</span> <span class="id" title="var">x</span>); <span class="id" title="tactic">case</span>: <a class="idref" href="chip.tarjan.html#colorP"><span class="id" title="lemma">colorP</span></a>=&gt; //=; <span class="id" title="tactic">case</span>: <a class="idref" href="chip.tarjan.html#colorP"><span class="id" title="lemma">colorP</span></a> <span class="id" title="var">x_gray</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">wf_stack_uniq</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="add_sccs_wf"><span class="id" title="lemma">add_sccs_wf</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span> :<br/>
&nbsp;&nbsp;<span class="id" title="definition">take</span> (<span class="id" title="definition">index</span> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>)) (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <span class="id" title="notation">\</span><span class="id" title="notation">subset</span> <a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#wf_env"><span class="id" title="record">wf_env</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#wf_env"><span class="id" title="record">wf_env</span></a> (<a class="idref" href="chip.tarjan.html#add_sccs"><span class="id" title="definition">add_sccs</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; /<span class="id" title="lemma">subsetP</span> <span class="id" title="var">new_blacks</span> <span class="id" title="var">x_gray</span> <span class="id" title="var">e_wf</span>.<br/>
<span class="id" title="var">have</span> [<span class="id" title="var">s_def</span> /<span class="id" title="lemma">subsetP</span> <span class="id" title="var">sccs_blacks</span> <span class="id" title="var">s_uniq</span>] := <span class="id" title="var">e_wf</span>.<br/>
<span class="id" title="tactic">split</span> =&gt; //=; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
- <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">subseq_uniq</span> (<a class="idref" href="chip.tarjan.html#drop_subseq"><span class="id" title="lemma">drop_subseq</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>
- <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">subsetP</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<span class="id" title="definition">cover</span> <span class="id" title="lemma">bigcup_setU</span> <span class="id" title="definition">inE</span> <span class="id" title="lemma">big_set1</span> !<span class="id" title="definition">inE</span> /= =&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orP"><span class="id" title="lemma">orP</span></a>[|/<span class="id" title="var">sccs_blacks</span>-&gt;];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbT"><span class="id" title="lemma">orbT</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mem_rcons</span> !<span class="id" title="definition">inE</span>; <span class="id" title="tactic">case</span>: <span class="id" title="lemma">eqP</span> =&gt; //= <span class="id" title="var">_</span> /<span class="id" title="var">new_blacks</span>.<br/>
<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">setP</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> /<span class="id" title="definition">cover</span> <span class="id" title="lemma">bigcup_setU</span> <span class="id" title="definition">inE</span> <span class="id" title="lemma">big_set1</span> !<span class="id" title="definition">inE</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#negb_or"><span class="id" title="lemma">negb_or</span></a>.<br/>
<span class="id" title="var">have</span> [-&gt;|<span class="id" title="var">neq_xy</span>] //= := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#altP"><span class="id" title="lemma">altP</span></a> (<span class="id" title="var">y</span> <span class="id" title="notation">=</span><span class="id" title="notation">P</span> <span class="id" title="var">x</span>); <span class="id" title="tactic">rewrite</span> ?<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andbT"><span class="id" title="lemma">andbT</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andbF"><span class="id" title="lemma">andbF</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">case</span>: <span class="id" title="lemma">splitP</span> <span class="id" title="var">new_blacks</span> <span class="id" title="var">s_uniq</span> =&gt; //=; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#grays_stack"><span class="id" title="lemma">grays_stack</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> <span class="id" title="var">s1x_blacks</span> <span class="id" title="var">s_uniq</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#grays_sccsF"><span class="id" title="lemma">grays_sccsF</span></a> // <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andbT"><span class="id" title="lemma">andbT</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (<a class="idref" href="chip.tarjan.html#uniq_catRL"><span class="id" title="lemma">uniq_catRL</span></a> <span class="id" title="var">s_uniq</span>) // <span class="id" title="lemma">mem_cat</span> <span class="id" title="lemma">mem_rcons</span> <span class="id" title="lemma">mem_head</span>.<br/>
<span class="id" title="tactic">case</span>: <a class="idref" href="chip.tarjan.html#colorP"><span class="id" title="lemma">colorP</span></a>; <span class="id" title="tactic">rewrite</span> ?<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andbT"><span class="id" title="lemma">andbT</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andbF"><span class="id" title="lemma">andbF</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbT"><span class="id" title="lemma">orbT</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbF"><span class="id" title="lemma">orbF</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> //=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y_sccs</span>; <span class="id" title="tactic">apply</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#contraTF"><span class="id" title="lemma">contraTF</span></a> <span class="id" title="var">y_sccs</span> =&gt; /<span class="id" title="lemma">mem_drop</span>; <span class="id" title="tactic">case</span>: <a class="idref" href="chip.tarjan.html#colorP"><span class="id" title="lemma">colorP</span></a>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y_blacks</span>; <span class="id" title="tactic">case</span>: <span class="id" title="lemma">splitP</span> <span class="id" title="var">s_uniq</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#grays_stack"><span class="id" title="lemma">grays_stack</span></a>.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> <span class="id" title="var">s_uniq</span> <span class="id" title="var">y_in</span>; <span class="id" title="tactic">apply</span>: <a class="idref" href="chip.tarjan.html#uniq_catRL"><span class="id" title="lemma">uniq_catRL</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="grays_add_blacks"><span class="id" title="lemma">grays_add_blacks</span></a> <span class="id" title="var">e</span> <span class="id" title="var">x</span> : <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> (<a class="idref" href="chip.tarjan.html#add_blacks"><span class="id" title="definition">add_blacks</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <span class="id" title="notation">:\</span> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">setP</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> /= <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#negb_or"><span class="id" title="lemma">negb_or</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andbA"><span class="id" title="lemma">andbA</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="whites_add_blacks"><span class="id" title="lemma">whites_add_blacks</span></a> <span class="id" title="var">e</span> <span class="id" title="var">x</span> : <a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> (<a class="idref" href="chip.tarjan.html#add_blacks"><span class="id" title="definition">add_blacks</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <span class="id" title="notation">:\</span> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">setP</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span>; <span class="id" title="tactic">case</span>: (<span class="id" title="var">_</span> <span class="id" title="notation">==</span> <span class="id" title="var">_</span>) (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="var">_</span>) (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="var">_</span>) =&gt; [] [].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="grays_add_sccs"><span class="id" title="lemma">grays_add_sccs</span></a> <span class="id" title="var">e</span> <span class="id" title="var">x</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">s</span> := <span class="id" title="definition">take</span> (<span class="id" title="definition">index</span> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>)) (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="definition">uniq</span> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <span class="id" title="notation">\</span><span class="id" title="notation">subset</span> <a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> (<a class="idref" href="chip.tarjan.html#add_sccs"><span class="id" title="definition">add_sccs</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <span class="id" title="notation">:\</span> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; /= <span class="id" title="var">se_uniq</span> <span class="id" title="var">sb</span> <span class="id" title="var">x_gray</span>; <span class="id" title="tactic">rewrite</span> /<a class="idref" href="chip.tarjan.html#add_sccs"><span class="id" title="definition">add_sccs</span></a> /<a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> /=.<br/>
<span class="id" title="tactic">case</span>: <span class="id" title="lemma">splitP</span> <span class="id" title="var">sb</span> <span class="id" title="var">se_uniq</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#grays_stack"><span class="id" title="lemma">grays_stack</span></a>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">s</span> <span class="id" title="var">s'</span> <span class="id" title="var">sb</span> <span class="id" title="var">sxs'_uniq</span>.<br/>
<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">setP</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> <span class="id" title="lemma">mem_cat</span> <span class="id" title="lemma">mem_rcons</span> <span class="id" title="lemma">in_cons</span>.<br/>
<span class="id" title="var">have</span> [-&gt;|] //= := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#altP"><span class="id" title="lemma">altP</span></a> <span class="id" title="lemma">eqP</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbC"><span class="id" title="lemma">orbC</span></a> ![<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">(</span></a><span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">notin</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <span class="id" title="var">_</span>]<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andbC"><span class="id" title="lemma">andbC</span></a>.<br/>
<span class="id" title="var">have</span> [|<span class="id" title="var">yNs'</span> <span class="id" title="var">neq_yx</span>] //= := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#boolP"><span class="id" title="lemma">boolP</span></a> (<span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="var">s'</span>).<br/>
<span class="id" title="tactic">by</span> <span class="id" title="var">have</span> [<span class="id" title="var">y_s</span>|] //= := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#boolP"><span class="id" title="lemma">boolP</span></a> (<span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="var">s</span>); <span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">subsetP</span> <span class="id" title="var">sb</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="whites_add_sccs"><span class="id" title="lemma">whites_add_sccs</span></a> <span class="id" title="var">e</span> <span class="id" title="var">x</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">s</span> := <span class="id" title="definition">take</span> (<span class="id" title="definition">index</span> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>)) (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="definition">uniq</span> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <span class="id" title="notation">\</span><span class="id" title="notation">subset</span> <a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> (<a class="idref" href="chip.tarjan.html#add_sccs"><span class="id" title="definition">add_sccs</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; /= <span class="id" title="var">x_gray</span> <span class="id" title="var">se_uniq</span> <span class="id" title="var">sb</span>; <span class="id" title="tactic">rewrite</span> /<a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> <a class="idref" href="chip.tarjan.html#grays_add_sccs"><span class="id" title="lemma">grays_add_sccs</span></a> //=.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">setUCA</span> <span class="id" title="lemma">setUA</span> <span class="id" title="lemma">setD1K</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="blacks_add_sccs"><span class="id" title="lemma">blacks_add_sccs</span></a> <span class="id" title="var">e</span> <span class="id" title="var">x</span> : <a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> (<a class="idref" href="chip.tarjan.html#add_sccs"><span class="id" title="definition">add_sccs</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="notation">|:</span> <a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> []. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="sccs_add_sccs"><span class="id" title="lemma">sccs_add_sccs</span></a> <span class="id" title="var">e</span> <span class="id" title="var">x</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">s</span> := <span class="id" title="definition">take</span> (<span class="id" title="definition">index</span> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>)) (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#sccs"><span class="id" title="projection">sccs</span></a> (<a class="idref" href="chip.tarjan.html#add_sccs"><span class="id" title="definition">add_sccs</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">[</span><span class="id" title="notation">set</span> <span class="id" title="var">y</span> <span class="id" title="notation">in</span> <span class="id" title="definition">rcons</span> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a><span class="id" title="notation">]</span> <span class="id" title="notation">|:</span> <a class="idref" href="chip.tarjan.html#sccs"><span class="id" title="projection">sccs</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> []. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="stack_add_sccs"><span class="id" title="lemma">stack_add_sccs</span></a> <span class="id" title="var">e</span> <span class="id" title="var">x</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">s</span> := <span class="id" title="definition">drop</span> <span class="id" title="notation">(</span><span class="id" title="definition">index</span> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>)<span class="id" title="notation">).+1</span> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> (<a class="idref" href="chip.tarjan.html#add_sccs"><span class="id" title="definition">add_sccs</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> []. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(***************)</span><br/>
<span class="comment">(*&nbsp;Rank&nbsp;Theory&nbsp;*)</span><br/>
<span class="comment">(***************)</span><br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="rankE"><span class="id" title="lemma">rankE</span></a> <span class="id" title="var">x</span> <span class="id" title="var">stack</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="variable">stack</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">if</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="variable">stack</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">then</span></a> <span class="id" title="definition">index</span> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> (<span class="id" title="definition">rev</span> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="variable">stack</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">else</span></a> <a class="idref" href="chip.tarjan.html#infty"><span class="id" title="abbreviation">infty</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">elim</span>: <span class="id" title="var">stack</span> =&gt; [|<span class="id" title="var">a</span> <span class="id" title="var">s</span> /= -&gt;] //.<br/>
<span class="id" title="var">have</span> [-&gt;|<span class="id" title="var">neq_xa</span>] /= := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#altP"><span class="id" title="lemma">altP</span></a> <span class="id" title="lemma">eqP</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">rev_cons</span> -<span class="id" title="lemma">cats1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mem_head</span> <span class="id" title="lemma">index_cat</span> <span class="id" title="lemma">mem_rev</span> /= <span class="id" title="abbreviation">eqxx</span> <span class="id" title="lemma">addn0</span> <span class="id" title="lemma">size_rev</span>; <span class="id" title="tactic">case</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#in_mem"><span class="id" title="definition">in_mem</span></a>.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">in_cons</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#negPf"><span class="id" title="lemma">negPf</span></a> <span class="id" title="var">neq_xa</span>) /= <span class="id" title="lemma">index_cat</span> /= <span class="id" title="lemma">mem_rev</span>; <span class="id" title="tactic">case</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#in_mem"><span class="id" title="definition">in_mem</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="rank_cons"><span class="id" title="lemma">rank_cons</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">s</span> : <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a> <span class="id" title="notation">::</span> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">if</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="notation">==</span> <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">notin</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">then</span></a> <span class="id" title="definition">size</span> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssreflect.html#00a1a5b58aac8f1e3f1abff064a39f9d"><span class="id" title="notation">else</span></a> <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> []. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="rank_catl"><span class="id" title="lemma">rank_catl</span></a> <span class="id" title="var">x</span> <span class="id" title="var">s</span> <span class="id" title="var">s'</span> : <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#s'"><span class="id" title="variable">s'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <span class="id" title="notation">++</span> <a class="idref" href="chip.tarjan.html#s'"><span class="id" title="variable">s'</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#s'"><span class="id" title="variable">s'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">x_s</span>; <span class="id" title="tactic">rewrite</span> !<a class="idref" href="chip.tarjan.html#rankE"><span class="id" title="lemma">rankE</span></a> <span class="id" title="lemma">rev_cat</span> <span class="id" title="lemma">mem_cat</span> <span class="id" title="var">x_s</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbT"><span class="id" title="lemma">orbT</span></a> <span class="id" title="lemma">index_cat</span> <span class="id" title="lemma">mem_rev</span> <span class="id" title="var">x_s</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="rank_catr"><span class="id" title="lemma">rank_catr</span></a> <span class="id" title="var">x</span> <span class="id" title="var">s</span> <span class="id" title="var">s'</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">notin</span></a> <a class="idref" href="chip.tarjan.html#s'"><span class="id" title="variable">s'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <span class="id" title="notation">++</span> <a class="idref" href="chip.tarjan.html#s'"><span class="id" title="variable">s'</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">size</span> <a class="idref" href="chip.tarjan.html#s'"><span class="id" title="variable">s'</span></a> <span class="id" title="notation">+</span> <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">x_s</span> <span class="id" title="var">xNs'</span>; <span class="id" title="tactic">rewrite</span> !<a class="idref" href="chip.tarjan.html#rankE"><span class="id" title="lemma">rankE</span></a> <span class="id" title="lemma">rev_cat</span> <span class="id" title="lemma">mem_cat</span> <span class="id" title="var">x_s</span> /=.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">index_cat</span> <span class="id" title="lemma">mem_rev</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#negPf"><span class="id" title="lemma">negPf</span></a> <span class="id" title="var">xNs'</span>) <span class="id" title="lemma">size_rev</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="rank_small"><span class="id" title="lemma">rank_small</span></a> <span class="id" title="var">x</span> <span class="id" title="var">s</span> : <span class="id" title="definition">uniq</span> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <span class="id" title="notation">&lt;</span> <span class="id" title="definition">size</span> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">s_uniq</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#rankE"><span class="id" title="lemma">rankE</span></a>; <span class="id" title="tactic">case</span>: (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#boolP"><span class="id" title="lemma">boolP</span></a> (<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="var">s</span>)) =&gt; [<span class="id" title="var">xNs</span>|<span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> -<span class="id" title="lemma">size_rev</span> <span class="id" title="lemma">index_mem</span> <span class="id" title="lemma">mem_rev</span>.<br/>
<span class="id" title="tactic">apply</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#negbTE"><span class="id" title="lemma">negbTE</span></a>; <span class="id" title="tactic">rewrite</span> -<span class="id" title="lemma">ltnNge</span> <span class="id" title="lemma">ltnS</span> <span class="id" title="lemma">cardE</span> <span class="id" title="lemma">uniq_leq_size</span> //.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mem_enum</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="var">Arguments</span> <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> : <span class="id" title="tactic">simpl</span> <span class="id" title="var">never</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="rank_le"><span class="id" title="lemma">rank_le</span></a> <span class="id" title="var">x</span> (<span class="id" title="var">s</span> : <span class="id" title="abbreviation">seq</span> <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a>) : <span class="id" title="definition">uniq</span> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <span class="id" title="notation">&lt;=</span> <a class="idref" href="chip.tarjan.html#infty"><span class="id" title="abbreviation">infty</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">s_uniq</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#rankE"><span class="id" title="lemma">rankE</span></a>; <span class="id" title="tactic">case</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#ifP"><span class="id" title="lemma">ifP</span></a> =&gt; // <span class="id" title="var">x_s</span>.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">leq_trans</span> (<span class="id" title="lemma">index_size</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) ?<span class="id" title="lemma">size_rev</span> -?(<span class="id" title="lemma">card_uniqP</span> <span class="id" title="var">_</span>) // <span class="id" title="lemma">max_card</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="rank_lt"><span class="id" title="lemma">rank_lt</span></a> <span class="id" title="var">x</span> (<span class="id" title="var">s</span> : <span class="id" title="abbreviation">seq</span> <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a>) : <span class="id" title="definition">uniq</span> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <span class="id" title="notation">&lt;</span> <a class="idref" href="chip.tarjan.html#infty"><span class="id" title="abbreviation">infty</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#rankE"><span class="id" title="lemma">rankE</span></a>; <span class="id" title="tactic">case</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#ifPn"><span class="id" title="lemma">ifPn</span></a>; <span class="id" title="tactic">rewrite</span> ?<span class="id" title="lemma">ltnn</span> // =&gt; <span class="id" title="var">x_s</span> <span class="id" title="var">s_uniq</span>.<br/>
<span class="id" title="tactic">rewrite</span> (@<span class="id" title="lemma">leq_trans</span> (<span class="id" title="definition">size</span> (<span class="id" title="definition">rev</span> <span class="id" title="var">s</span>))) ?<span class="id" title="lemma">index_mem</span> ?<span class="id" title="lemma">mem_rev</span> ?<span class="id" title="lemma">size_rev</span> //.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> -?(<span class="id" title="lemma">card_uniqP</span> <span class="id" title="var">_</span>) // <span class="id" title="lemma">max_card</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="rank_infty"><span class="id" title="lemma">rank_infty</span></a> <span class="id" title="var">x</span> (<span class="id" title="var">s</span> : <span class="id" title="abbreviation">seq</span> <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a>) : <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">notin</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#infty"><span class="id" title="abbreviation">infty</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#rankE"><span class="id" title="lemma">rankE</span></a> =&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#negPf"><span class="id" title="lemma">negPf</span></a>-&gt;. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="rank_mem"><span class="id" title="lemma">rank_mem</span></a> <span class="id" title="var">x</span> <span class="id" title="var">s</span> : <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <span class="id" title="notation">&lt;</span> <span class="id" title="definition">size</span> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">x_s</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#rankE"><span class="id" title="lemma">rankE</span></a> <span class="id" title="var">x_s</span> -<span class="id" title="lemma">size_rev</span> <span class="id" title="lemma">index_mem</span> <span class="id" title="lemma">mem_rev</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="rank_le_head"><span class="id" title="lemma">rank_le_head</span></a> <span class="id" title="var">s</span> <span class="id" title="var">z</span> <span class="id" title="var">x</span> : <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">notin</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#z"><span class="id" title="variable">z</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#z"><span class="id" title="variable">z</span></a> (<a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="notation">::</span> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a>) <span class="id" title="notation">&lt;</span> <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="notation">::</span> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">xNs</span> <span class="id" title="var">z_s</span>; <span class="id" title="tactic">rewrite</span> !<a class="idref" href="chip.tarjan.html#rank_cons"><span class="id" title="lemma">rank_cons</span></a> <span class="id" title="var">z_s</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andbF"><span class="id" title="lemma">andbF</span></a> <span class="id" title="abbreviation">eqxx</span> <span class="id" title="var">xNs</span> /= <a class="idref" href="chip.tarjan.html#rank_mem"><span class="id" title="lemma">rank_mem</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(********************)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;Main&nbsp;Proof&nbsp;!&nbsp;&nbsp;&nbsp;*)</span><br/>
<span class="comment">(********************)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="noblack_to_white"><span class="id" title="definition">noblack_to_white</span></a> <span class="id" title="var">e</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="notation">[</span><span class="id" title="notation">disjoint</span> <a class="idref" href="chip.tarjan.html#tarjan.successors"><span class="id" title="variable">successors</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="notation">&amp;</span> <a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a><span class="id" title="notation">]</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="wf_graph"><span class="id" title="record">wf_graph</span></a> <span class="id" title="var">e</span> := <a name="WfGraph"><span class="id" title="constructor">WfGraph</span></a> {<br/>
&nbsp;&nbsp;<a name="wf_grays_to_stack"><span class="id" title="projection">wf_grays_to_stack</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5f76d9959f82823e4253cd67e7dc0e96"><span class="id" title="notation">{</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5f76d9959f82823e4253cd67e7dc0e96"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5f76d9959f82823e4253cd67e7dc0e96"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5f76d9959f82823e4253cd67e7dc0e96"><span class="id" title="notation">,</span></a> <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <span class="id" title="notation">&lt;=</span> <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#gconnect"><span class="id" title="abbreviation">gconnect</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#5f76d9959f82823e4253cd67e7dc0e96"><span class="id" title="notation">}</span></a>;<br/>
&nbsp;&nbsp;<a name="wf_stack_to_grays"><span class="id" title="projection">wf_stack_to_grays</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">y</span>, <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">[/\</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <span class="id" title="notation">&lt;=</span> <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="chip.tarjan.html#gconnect"><span class="id" title="abbreviation">gconnect</span></a> <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="access_to"><span class="id" title="definition">access_to</span></a> <span class="id" title="var">e</span> (<span class="id" title="var">roots</span> : <span class="id" title="notation">{</span><span class="id" title="notation">set</span> <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">}</span>) :=<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span>, <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#roots"><span class="id" title="variable">roots</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#gconnect"><span class="id" title="abbreviation">gconnect</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="black_gsccs"><span class="id" title="definition">black_gsccs</span></a> <span class="id" title="var">e</span> := <span class="id" title="notation">[</span><span class="id" title="notation">set</span> <span class="id" title="var">scc</span> <span class="id" title="notation">in</span> <a class="idref" href="chip.tarjan.html#gsccs"><span class="id" title="definition">gsccs</span></a> <span class="id" title="notation">|</span> <a class="idref" href="chip.tarjan.html#scc"><span class="id" title="variable">scc</span></a> <span class="id" title="notation">\</span><span class="id" title="notation">subset</span> <a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a><span class="id" title="notation">]</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="pre_dfs"><span class="id" title="record">pre_dfs</span></a> (<span class="id" title="var">roots</span> : <span class="id" title="notation">{</span><span class="id" title="notation">set</span> <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">}</span>) (<span class="id" title="var">e</span> : <a class="idref" href="chip.tarjan.html#env"><span class="id" title="record">env</span></a>) := <a name="PreDfs"><span class="id" title="constructor">PreDfs</span></a> {<br/>
&nbsp;&nbsp;<a name="pre_access_to"><span class="id" title="projection">pre_access_to</span></a> : <a class="idref" href="chip.tarjan.html#access_to"><span class="id" title="definition">access_to</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="chip.tarjan.html#roots"><span class="id" title="variable">roots</span></a>;<br/>
&nbsp;&nbsp;<a name="pre_wf_env"><span class="id" title="projection">pre_wf_env</span></a> : <a class="idref" href="chip.tarjan.html#wf_env"><span class="id" title="record">wf_env</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>;<br/>
&nbsp;&nbsp;<a name="pre_wf_graph"><span class="id" title="projection">pre_wf_graph</span></a> : <a class="idref" href="chip.tarjan.html#wf_graph"><span class="id" title="record">wf_graph</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>;<br/>
&nbsp;&nbsp;<a name="wf_noblack_towhite"><span class="id" title="projection">wf_noblack_towhite</span></a> : <a class="idref" href="chip.tarjan.html#noblack_to_white"><span class="id" title="definition">noblack_to_white</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>;<br/>
&nbsp;&nbsp;<a name="pre_sccs"><span class="id" title="projection">pre_sccs</span></a> : <a class="idref" href="chip.tarjan.html#sccs"><span class="id" title="projection">sccs</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#black_gsccs"><span class="id" title="definition">black_gsccs</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>;<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="add_stack_gwf"><span class="id" title="lemma">add_stack_gwf</span></a> <span class="id" title="var">e</span> <span class="id" title="var">w</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#access_to"><span class="id" title="definition">access_to</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <span class="id" title="notation">[</span><span class="id" title="notation">set</span> <a class="idref" href="chip.tarjan.html#w"><span class="id" title="variable">w</span></a><span class="id" title="notation">]</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#wf_env"><span class="id" title="record">wf_env</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#wf_graph"><span class="id" title="record">wf_graph</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#wf_graph"><span class="id" title="record">wf_graph</span></a> (<a class="idref" href="chip.tarjan.html#add_stack"><span class="id" title="definition">add_stack</span></a> <a class="idref" href="chip.tarjan.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">grays_to</span> <span class="id" title="var">e_wf</span> <span class="id" title="var">w_white</span> [<span class="id" title="var">gs</span> <span class="id" title="var">sg</span>]; <span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#grays_add_stack"><span class="id" title="lemma">grays_add_stack</span></a> //= =&gt; <span class="id" title="var">x</span> <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#rank_cons"><span class="id" title="lemma">rank_cons</span></a> !<span class="id" title="definition">inE</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orP"><span class="id" title="lemma">orP</span></a>[/<span class="id" title="lemma">eqP</span>-&gt;|/<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[<span class="id" title="var">xNb</span> <span class="id" title="var">xs</span>]] /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orP"><span class="id" title="lemma">orP</span></a>[/<span class="id" title="lemma">eqP</span>-&gt;|/=<span class="id" title="var">ys</span>];<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ?<a class="idref" href="chip.tarjan.html#rank_cons"><span class="id" title="lemma">rank_cons</span></a> ?<span class="id" title="abbreviation">eqxx</span> ?(@<a class="idref" href="chip.tarjan.html#whites_stackF"><span class="id" title="lemma">whites_stackF</span></a> <span class="id" title="var">w</span>) ?<span class="id" title="var">xs</span> ?<span class="id" title="var">ys</span> ?<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andbF"><span class="id" title="lemma">andbF</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andbT"><span class="id" title="lemma">andbT</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> //=.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">leqNgt</span> <a class="idref" href="chip.tarjan.html#rank_small"><span class="id" title="lemma">rank_small</span></a> ?<a class="idref" href="chip.tarjan.html#wf_stack_uniq"><span class="id" title="projection">wf_stack_uniq</span></a> // <span class="id" title="var">ys</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">_</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">grays_to</span> ?<span class="id" title="definition">inE</span> //= <span class="id" title="var">xNb</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>: <span class="id" title="var">gs</span>; <span class="id" title="tactic">rewrite</span> ?<span class="id" title="definition">inE</span> ?<span class="id" title="var">xNb</span>.<br/>
- <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span> =&gt; /<span class="id" title="lemma">predU1P</span> [-&gt;|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">w</span>; <span class="id" title="tactic">rewrite</span> ?<a class="idref" href="chip.tarjan.html#grays_add_stack"><span class="id" title="lemma">grays_add_stack</span></a> ?<span class="id" title="definition">inE</span> ?<span class="id" title="abbreviation">eqxx</span> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#whites_blacksF"><span class="id" title="lemma">whites_blacksF</span></a> ?<a class="idref" href="chip.tarjan.html#whites_stackF"><span class="id" title="lemma">whites_stackF</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y_stack</span>; <span class="id" title="var">have</span> /<span class="id" title="var">sg</span> [<span class="id" title="var">x</span> [<span class="id" title="var">x_gray</span> <span class="id" title="var">le_xy</span> <span class="id" title="var">y_to_x</span>]] := <span class="id" title="var">y_stack</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">split</span>=&gt; //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#grays_add_stack"><span class="id" title="lemma">grays_add_stack</span></a> // <span class="id" title="definition">inE</span> <span class="id" title="var">x_gray</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbT"><span class="id" title="lemma">orbT</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#stack_add_stack"><span class="id" title="lemma">stack_add_stack</span></a> !<a class="idref" href="chip.tarjan.html#rank_cons"><span class="id" title="lemma">rank_cons</span></a> [<span class="id" title="var">x</span> <span class="id" title="notation">==</span> <span class="id" title="var">w</span>]<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#negbTE"><span class="id" title="lemma">negbTE</span></a> /= 1?[<span class="id" title="var">y</span> <span class="id" title="notation">==</span> <span class="id" title="var">w</span>]<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#negbTE"><span class="id" title="lemma">negbTE</span></a> //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>: <span class="id" title="lemma">contraTneq</span> <span class="id" title="var">y_stack</span> =&gt; -&gt;; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#whites_stackF"><span class="id" title="lemma">whites_stackF</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>: <span class="id" title="lemma">contraTneq</span> <span class="id" title="var">x_gray</span> =&gt; -&gt;; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#whites_graysF"><span class="id" title="lemma">whites_graysF</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="add_stack_pre"><span class="id" title="lemma">add_stack_pre</span></a> <span class="id" title="var">e</span> <span class="id" title="var">w</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#access_to"><span class="id" title="definition">access_to</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <span class="id" title="notation">[</span><span class="id" title="notation">set</span> <a class="idref" href="chip.tarjan.html#w"><span class="id" title="variable">w</span></a><span class="id" title="notation">]</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#wf_env"><span class="id" title="record">wf_env</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#wf_graph"><span class="id" title="record">wf_graph</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#access_to"><span class="id" title="definition">access_to</span></a> (<a class="idref" href="chip.tarjan.html#add_stack"><span class="id" title="definition">add_stack</span></a> <a class="idref" href="chip.tarjan.html#w"><span class="id" title="variable">w</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <span class="id" title="notation">[</span><span class="id" title="notation">set</span> <span class="id" title="var">x</span> <span class="id" title="notation">in</span> <a class="idref" href="chip.tarjan.html#tarjan.successors"><span class="id" title="variable">successors</span></a> <a class="idref" href="chip.tarjan.html#w"><span class="id" title="variable">w</span></a><span class="id" title="notation">]</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">grays_to</span> <span class="id" title="var">e_wf</span> <span class="id" title="var">w_white</span> <span class="id" title="var">e_gwf</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">x</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#grays_add_stack"><span class="id" title="lemma">grays_add_stack</span></a> // 2?<span class="id" title="definition">inE</span> =&gt; /<span class="id" title="lemma">predU1P</span> [-&gt;|].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span> =&gt; <span class="id" title="var">y_succ_w</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">connect1</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; /<span class="id" title="var">grays_to</span> <span class="id" title="var">x_to_y</span> <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span> =&gt; <span class="id" title="var">y_succ_w</span>.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">connect_trans</span> <span class="id" title="var">_</span> (<span class="id" title="lemma">connect1</span> <span class="id" title="var">y_succ_w</span>)) // <span class="id" title="var">x_to_y</span> ?<span class="id" title="definition">inE</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="xedges"><span class="id" title="definition">xedges</span></a> (<span class="id" title="var">new</span> <span class="id" title="var">old</span> : <span class="id" title="abbreviation">seq</span> <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="notation">[</span><span class="id" title="notation">set</span> <span class="id" title="var">y</span> <span class="id" title="notation">in</span> <a class="idref" href="chip.tarjan.html#old"><span class="id" title="variable">old</span></a> <span class="id" title="notation">|</span> <span class="id" title="notation">[</span><span class="id" title="notation">exists</span> <span class="id" title="var">x</span> <span class="id" title="notation">in</span> <a class="idref" href="chip.tarjan.html#new"><span class="id" title="variable">new</span></a><span class="id" title="notation">,</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">notin</span></a> <a class="idref" href="chip.tarjan.html#old"><span class="id" title="variable">old</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="chip.tarjan.html#edge"><span class="id" title="abbreviation">edge</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a><span class="id" title="notation">]</span><span class="id" title="notation">]</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="rank_of_reachable"><span class="id" title="definition">rank_of_reachable</span></a> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#3df228c109f14f0423b4fccc967ee1ac"><span class="id" title="notation">exists2</span></a> <span class="id" title="var">y</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#3df228c109f14f0423b4fccc967ee1ac"><span class="id" title="notation">,</span></a> <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#gconnect"><span class="id" title="abbreviation">gconnect</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#3df228c109f14f0423b4fccc967ee1ac"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="chip.tarjan.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="post_dfs"><span class="id" title="definition">post_dfs</span></a> (<span class="id" title="var">roots</span> : <span class="id" title="notation">{</span><span class="id" title="notation">set</span> <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">}</span>) (<span class="id" title="var">e</span> <span class="id" title="var">e'</span> : <a class="idref" href="chip.tarjan.html#env"><span class="id" title="record">env</span></a>) (<span class="id" title="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :=<br/>
<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">[/\</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b76985613d3b3ca583bb3217c76109bb"><span class="id" title="notation">[/\</span></a> <a class="idref" href="chip.tarjan.html#wf_env"><span class="id" title="record">wf_env</span></a> <a class="idref" href="chip.tarjan.html#e'"><span class="id" title="variable">e'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b76985613d3b3ca583bb3217c76109bb"><span class="id" title="notation">,</span></a> <a class="idref" href="chip.tarjan.html#wf_graph"><span class="id" title="record">wf_graph</span></a> <a class="idref" href="chip.tarjan.html#e'"><span class="id" title="variable">e'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b76985613d3b3ca583bb3217c76109bb"><span class="id" title="notation">,</span></a> <a class="idref" href="chip.tarjan.html#noblack_to_white"><span class="id" title="definition">noblack_to_white</span></a> <a class="idref" href="chip.tarjan.html#e'"><span class="id" title="variable">e'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b76985613d3b3ca583bb3217c76109bb"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <a class="idref" href="chip.tarjan.html#e'"><span class="id" title="variable">e'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b76985613d3b3ca583bb3217c76109bb"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="chip.tarjan.html#sccs"><span class="id" title="projection">sccs</span></a> <a class="idref" href="chip.tarjan.html#e'"><span class="id" title="variable">e'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#black_gsccs"><span class="id" title="definition">black_gsccs</span></a> <a class="idref" href="chip.tarjan.html#e'"><span class="id" title="variable">e'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b76985613d3b3ca583bb3217c76109bb"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">,</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">[/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#3df228c109f14f0423b4fccc967ee1ac"><span class="id" title="notation">exists2</span></a> <span class="id" title="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#3df228c109f14f0423b4fccc967ee1ac"><span class="id" title="notation">,</span></a> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e'"><span class="id" title="variable">e'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <span class="id" title="notation">++</span> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#3df228c109f14f0423b4fccc967ee1ac"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <span class="id" title="notation">\</span><span class="id" title="notation">subset</span> <span class="id" title="notation">(</span><a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <a class="idref" href="chip.tarjan.html#e'"><span class="id" title="variable">e'</span></a><span class="id" title="notation">)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <span class="id" title="notation">\</span><span class="id" title="notation">subset</span> <a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <a class="idref" href="chip.tarjan.html#e'"><span class="id" title="variable">e'</span></a>  <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="chip.tarjan.html#sccs"><span class="id" title="projection">sccs</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <span class="id" title="notation">\</span><span class="id" title="notation">subset</span> <a class="idref" href="chip.tarjan.html#sccs"><span class="id" title="projection">sccs</span></a> <a class="idref" href="chip.tarjan.html#e'"><span class="id" title="variable">e'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">]&amp;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">[/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#roots"><span class="id" title="variable">roots</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="notation">&lt;=</span> <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e'"><span class="id" title="variable">e'</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#infty"><span class="id" title="abbreviation">infty</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#3df228c109f14f0423b4fccc967ee1ac"><span class="id" title="notation">exists2</span></a> <span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#3df228c109f14f0423b4fccc967ee1ac"><span class="id" title="notation">,</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#roots"><span class="id" title="variable">roots</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#3df228c109f14f0423b4fccc967ee1ac"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="chip.tarjan.html#rank_of_reachable"><span class="id" title="definition">rank_of_reachable</span></a> <a class="idref" href="chip.tarjan.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e'"><span class="id" title="variable">e'</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span>, <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#xedges"><span class="id" title="definition">xedges</span></a> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e'"><span class="id" title="variable">e'</span></a>) (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="notation">&lt;=</span> <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <a class="idref" href="chip.tarjan.html#e'"><span class="id" title="variable">e'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">]</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="dfs1_correct"><span class="id" title="definition">dfs1_correct</span></a> (<span class="id" title="var">dfs1</span> : <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#env"><span class="id" title="record">env</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="chip.tarjan.html#env"><span class="id" title="record">env</span></a>) <span class="id" title="var">x</span> <span class="id" title="var">e</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#pre_dfs"><span class="id" title="record">pre_dfs</span></a> <span class="id" title="notation">[</span><span class="id" title="notation">set</span> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a><span class="id" title="notation">]</span> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">m</span>, <span class="id" title="var">e'</span>) := <a class="idref" href="chip.tarjan.html#dfs1"><span class="id" title="variable">dfs1</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <a class="idref" href="chip.tarjan.html#e'"><span class="id" title="variable">e'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="chip.tarjan.html#post_dfs"><span class="id" title="definition">post_dfs</span></a> <span class="id" title="notation">[</span><span class="id" title="notation">set</span> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a><span class="id" title="notation">]</span> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="chip.tarjan.html#e'"><span class="id" title="variable">e'</span></a> <a class="idref" href="chip.tarjan.html#m"><span class="id" title="variable">m</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="dfs'_correct"><span class="id" title="definition">dfs'_correct</span></a> (<span class="id" title="var">dfs'</span> : <span class="id" title="notation">{</span><span class="id" title="notation">set</span> <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">}</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#env"><span class="id" title="record">env</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="chip.tarjan.html#env"><span class="id" title="record">env</span></a>) <span class="id" title="var">roots</span> <span class="id" title="var">e</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#pre_dfs"><span class="id" title="record">pre_dfs</span></a> <a class="idref" href="chip.tarjan.html#roots"><span class="id" title="variable">roots</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">m</span>, <span class="id" title="var">e'</span>) := <a class="idref" href="chip.tarjan.html#dfs'"><span class="id" title="variable">dfs'</span></a> <a class="idref" href="chip.tarjan.html#roots"><span class="id" title="variable">roots</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#roots"><span class="id" title="variable">roots</span></a> <span class="id" title="notation">\</span><span class="id" title="notation">subset</span> <a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <a class="idref" href="chip.tarjan.html#e'"><span class="id" title="variable">e'</span></a> <span class="id" title="notation">:|:</span> <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <a class="idref" href="chip.tarjan.html#e'"><span class="id" title="variable">e'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="chip.tarjan.html#post_dfs"><span class="id" title="definition">post_dfs</span></a> <a class="idref" href="chip.tarjan.html#roots"><span class="id" title="variable">roots</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="chip.tarjan.html#e'"><span class="id" title="variable">e'</span></a> <a class="idref" href="chip.tarjan.html#m"><span class="id" title="variable">m</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="pre_dfs_subroots"><span class="id" title="lemma">pre_dfs_subroots</span></a> (<span class="id" title="var">roots</span> <span class="id" title="var">roots'</span> : <span class="id" title="notation">{</span><span class="id" title="notation">set</span> <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">}</span>) <span class="id" title="var">e</span> : <a class="idref" href="chip.tarjan.html#roots'"><span class="id" title="variable">roots'</span></a> <span class="id" title="notation">\</span><span class="id" title="notation">subset</span> <a class="idref" href="chip.tarjan.html#roots"><span class="id" title="variable">roots</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#pre_dfs"><span class="id" title="record">pre_dfs</span></a> <a class="idref" href="chip.tarjan.html#roots"><span class="id" title="variable">roots</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#pre_dfs"><span class="id" title="record">pre_dfs</span></a> <a class="idref" href="chip.tarjan.html#roots'"><span class="id" title="variable">roots'</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">sub_roots</span> [<span class="id" title="var">to_roots</span> <span class="id" title="var">e_wf</span> <span class="id" title="var">e_gwf</span> <span class="id" title="var">black_sccs</span> <span class="id" title="var">Nbw</span>]; <span class="id" title="tactic">split</span>=&gt; //.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">x</span> <span class="id" title="var">x_gray</span> <span class="id" title="var">y</span> <span class="id" title="var">y_roots'</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">to_roots</span> //; <span class="id" title="tactic">apply</span>: <span class="id" title="lemma">subsetP</span> <span class="id" title="var">y_roots'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="dfs'_is_correct"><span class="id" title="lemma">dfs'_is_correct</span></a> <span class="id" title="var">dfs1</span> <span class="id" title="var">dfsrec'</span> (<span class="id" title="var">roots</span> : <span class="id" title="notation">{</span><span class="id" title="notation">set</span> <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">}</span>) <span class="id" title="var">e</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#roots"><span class="id" title="variable">roots</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#dfs1_correct"><span class="id" title="definition">dfs1_correct</span></a> <a class="idref" href="chip.tarjan.html#dfs1"><span class="id" title="variable">dfs1</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#roots"><span class="id" title="variable">roots</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">forall</span> <span class="id" title="var">e1</span>, <a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> <a class="idref" href="chip.tarjan.html#e1"><span class="id" title="variable">e1</span></a> <span class="id" title="notation">\</span><span class="id" title="notation">subset</span> <a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#dfs'_correct"><span class="id" title="definition">dfs'_correct</span></a> <a class="idref" href="chip.tarjan.html#dfsrec'"><span class="id" title="variable">dfsrec'</span></a> (<a class="idref" href="chip.tarjan.html#roots"><span class="id" title="variable">roots</span></a> <span class="id" title="notation">:\</span> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a>) <a class="idref" href="chip.tarjan.html#e1"><span class="id" title="variable">e1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#dfs'_correct"><span class="id" title="definition">dfs'_correct</span></a> (<a class="idref" href="chip.tarjan.html#dfs'"><span class="id" title="definition">dfs'</span></a> <a class="idref" href="chip.tarjan.html#dfs1"><span class="id" title="variable">dfs1</span></a> <a class="idref" href="chip.tarjan.html#dfsrec'"><span class="id" title="variable">dfsrec'</span></a>) <a class="idref" href="chip.tarjan.html#roots"><span class="id" title="variable">roots</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">dfs1_is_correct</span> <span class="id" title="var">dfs'_is_correct</span>; <span class="id" title="tactic">rewrite</span> /<a class="idref" href="chip.tarjan.html#dfs'_correct"><span class="id" title="definition">dfs'_correct</span></a> /<a class="idref" href="chip.tarjan.html#dfs'"><span class="id" title="definition">dfs'</span></a>.<br/>
<span class="id" title="tactic">case</span>: <span class="id" title="lemma">pickP</span> =&gt; [<span class="id" title="var">x</span>|<span class="id" title="var">no_roots</span>]; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; [<span class="id" title="var">gto_roots</span> <span class="id" title="var">e_wf</span> <span class="id" title="var">e_gwf</span> <span class="id" title="var">black_sccs</span>]; <span class="id" title="tactic">split</span>=&gt; //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">subsetP</span>=&gt; <span class="id" title="var">x</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> <span class="id" title="var">no_roots</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>=&gt; //; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">split</span>=&gt; //; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">exists</span> <span class="id" title="notation">[::]</span> =&gt; //; <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">subsetP</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>=&gt; //; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">x</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">no_roots</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span> =&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[<span class="id" title="var">_</span> /<span class="id" title="lemma">existsP</span> [<span class="id" title="var">x</span> /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#and3P"><span class="id" title="lemma">and3P</span></a>[-&gt;]]].<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">x_root</span>; <span class="id" title="var">have</span> := <span class="id" title="var">dfs'_is_correct</span> <span class="id" title="var">_</span> <span class="id" title="var">x_root</span>; <span class="id" title="tactic">rewrite</span> /<a class="idref" href="chip.tarjan.html#dfs'_correct"><span class="id" title="definition">dfs'_correct</span></a>.<br/>
<span class="id" title="tactic">case</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#ifPn"><span class="id" title="lemma">ifPn</span></a>=&gt; [<span class="id" title="var">x_stack</span>|<span class="id" title="var">xNstack</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; /(<span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="lemma">subxx</span> <span class="id" title="var">_</span>)); <span class="id" title="tactic">case</span>: (<span class="id" title="var">dfsrec'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) =&gt; [<span class="id" title="var">m2</span> <span class="id" title="var">e'</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">e'_correct</span> [<span class="id" title="var">to_roots</span> <span class="id" title="var">e_wf</span> <span class="id" title="var">e_gwf</span> <span class="id" title="var">Nbw</span> <span class="id" title="var">black_sccs</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">e_uniq</span> := <a class="idref" href="chip.tarjan.html#wf_stack_uniq"><span class="id" title="projection">wf_stack_uniq</span></a> <span class="id" title="var">e_wf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">case</span>: <span class="id" title="var">e'_correct</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">exact</span>: (<a class="idref" href="chip.tarjan.html#pre_dfs_subroots"><span class="id" title="lemma">pre_dfs_subroots</span></a> (<span class="id" title="lemma">subD1set</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">change_color</span> [<span class="id" title="var">invariants</span> <span class="id" title="var">monotony</span> [<span class="id" title="var">pc1</span> <span class="id" title="var">pc2</span> <span class="id" title="var">pc3</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>=&gt; //.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> -(<span class="id" title="lemma">setD1K</span> <span class="id" title="var">x_root</span>) <span class="id" title="lemma">subUset</span> <span class="id" title="var">change_color</span> <span class="id" title="lemma">sub1set</span> !<span class="id" title="definition">inE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> [//|<span class="id" title="var">xNblack</span> /=] := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#boolP"><span class="id" title="lemma">boolP</span></a> (<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#blacks"><span class="id" title="projection">blacks</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">have</span> [[<span class="id" title="var">s</span> -&gt;]] := <span class="id" title="var">monotony</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mem_cat</span> <span class="id" title="var">x_stack</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbT"><span class="id" title="lemma">orbT</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>=&gt; //; <span class="id" title="tactic">split</span>=&gt; //.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y</span> <span class="id" title="var">y_root</span>; <span class="id" title="var">have</span> [-&gt;|<span class="id" title="var">neq_yx</span>]:= <span class="id" title="lemma">eqVneq</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">geq_min</span> <span class="id" title="var">pc1</span> ?<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbT"><span class="id" title="lemma">orbT</span></a> // !<span class="id" title="definition">inE</span> <span class="id" title="var">neq_yx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">have</span> [[<span class="id" title="var">s</span> -&gt; <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>]] := <span class="id" title="var">monotony</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#rank_catl"><span class="id" title="lemma">rank_catl</span></a> // <span class="id" title="lemma">geq_min</span> <span class="id" title="lemma">leqnn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">right</span>; <span class="id" title="tactic">case</span>: (<span class="id" title="lemma">leqP</span> (<a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <span class="id" title="var">x</span> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">e</span>)) <span class="id" title="var">m2</span>) =&gt; [<span class="id" title="var">rx_small</span>|/<span class="id" title="lemma">ltnW</span> <span class="id" title="var">rx_big</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">minn_idPl</span> <span class="id" title="var">_</span>) //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">x</span> =&gt; //; <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">rewrite</span> ?<span class="id" title="definition">inE</span> ?<span class="id" title="lemma">connect0</span> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">have</span> [[<span class="id" title="var">s</span> -&gt;]] := <span class="id" title="var">monotony</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#rank_catl"><span class="id" title="lemma">rank_catl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">minn_idPr</span> <span class="id" title="var">_</span>) //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">case</span>: <span class="id" title="var">pc2</span> <span class="id" title="var">rx_big</span>=&gt; [-&gt;|[<span class="id" title="var">y</span>]]; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">leqNgt</span> <a class="idref" href="chip.tarjan.html#rank_lt"><span class="id" title="lemma">rank_lt</span></a> ?<span class="id" title="var">x_stack</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> =&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[<span class="id" title="var">neq_yx</span> <span class="id" title="var">y_roots</span> [<span class="id" title="var">z</span> <span class="id" title="var">y_to_z</span> <span class="id" title="var">m_def</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">m_small</span>; <span class="id" title="tactic">exists</span> <span class="id" title="var">y</span> =&gt; //; <span class="id" title="tactic">exists</span> <span class="id" title="var">z</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y</span> <span class="id" title="var">y_xedge</span>; <span class="id" title="tactic">rewrite</span> (@<span class="id" title="lemma">leq_trans</span> <span class="id" title="var">m2</span>) ?<span class="id" title="var">pc3</span> // <span class="id" title="lemma">geq_min</span> <span class="id" title="lemma">leqnn</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbT"><span class="id" title="lemma">orbT</span></a>.<br/>
<span class="id" title="tactic">case</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#ifPn"><span class="id" title="lemma">ifPn</span></a>=&gt; [<span class="id" title="var">x_black</span>|<span class="id" title="var">xNblack</span>] //=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; /(<span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="lemma">subxx</span> <span class="id" title="var">_</span>)); <span class="id" title="tactic">case</span>: (<span class="id" title="var">dfsrec'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) =&gt; [<span class="id" title="var">m2</span> <span class="id" title="var">e'</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">e'_correct</span> [<span class="id" title="var">to_roots</span> <span class="id" title="var">e_wf</span> <span class="id" title="var">e_gwf</span> <span class="id" title="var">Nbw</span> <span class="id" title="var">black_sccs</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">case</span>: <span class="id" title="var">e'_correct</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">exact</span>: (<a class="idref" href="chip.tarjan.html#pre_dfs_subroots"><span class="id" title="lemma">pre_dfs_subroots</span></a> (<span class="id" title="lemma">subD1set</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">change_color</span> [[<span class="id" title="var">e'_wf</span> <span class="id" title="var">e'_gwf</span> <span class="id" title="var">keep_gray</span> <span class="id" title="var">Nbw'</span> <span class="id" title="var">sccs'_black</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">mon1</span> <span class="id" title="var">mon2</span> <span class="id" title="var">mon3</span>] [<span class="id" title="var">pc1</span> <span class="id" title="var">pc2</span> <span class="id" title="var">pc3</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">e'_uniq</span> := <a class="idref" href="chip.tarjan.html#wf_stack_uniq"><span class="id" title="projection">wf_stack_uniq</span></a> <span class="id" title="var">e'_wf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>=&gt; //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> -(<span class="id" title="lemma">setD1K</span> <span class="id" title="var">x_root</span>) <span class="id" title="lemma">subUset</span> <span class="id" title="var">change_color</span> <span class="id" title="lemma">sub1set</span> !<span class="id" title="definition">inE</span> (<span class="id" title="lemma">subsetP</span> <span class="id" title="var">mon2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">m2_rank</span>: <span class="id" title="var">m2</span> <span class="id" title="notation">&lt;=</span> <a class="idref" href="chip.tarjan.html#infty"><span class="id" title="abbreviation">infty</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">case</span>: <span class="id" title="var">pc2</span>=&gt; [-&gt;|[?? [??-&gt;]]]; <span class="id" title="tactic">rewrite</span> ?<a class="idref" href="chip.tarjan.html#rank_le"><span class="id" title="lemma">rank_le</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>=&gt; //; <span class="id" title="tactic">split</span>=&gt; //.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y</span> <span class="id" title="var">y_root</span>; <span class="id" title="var">have</span> [-&gt;{<span class="id" title="var">y</span> <span class="id" title="var">y_root</span>}|<span class="id" title="var">neq_yx</span>]:= <span class="id" title="lemma">eqVneq</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">geq_min</span> <span class="id" title="var">pc1</span> ?<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbT"><span class="id" title="lemma">orbT</span></a> // !<span class="id" title="definition">inE</span> <span class="id" title="var">neq_yx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#rank_infty"><span class="id" title="lemma">rank_infty</span></a> ?<span class="id" title="lemma">geq_min</span> ?<span class="id" title="lemma">leqnn</span> // <a class="idref" href="chip.tarjan.html#sccs_stackF"><span class="id" title="lemma">sccs_stackF</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>: (<span class="id" title="lemma">subsetP</span> (<a class="idref" href="chip.tarjan.html#subset_bigcup"><span class="id" title="lemma">subset_bigcup</span></a> <span class="id" title="var">mon3</span>)); <span class="id" title="tactic">case</span>: <a class="idref" href="chip.tarjan.html#colorP"><span class="id" title="lemma">colorP</span></a> <span class="id" title="var">x_black</span> <span class="id" title="var">xNstack</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">minn_idPr</span> <span class="id" title="var">_</span>) //; <span class="id" title="tactic">case</span>: <span class="id" title="var">pc2</span> =&gt; [-&gt;//|]; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; [<span class="id" title="var">y</span>]; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> =&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[<span class="id" title="var">_</span> ?]; <span class="id" title="tactic">right</span>; <span class="id" title="tactic">exists</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y</span> <span class="id" title="var">y_xedge</span>; <span class="id" title="tactic">rewrite</span> (@<span class="id" title="lemma">leq_trans</span> <span class="id" title="var">m2</span>) ?<span class="id" title="var">pc3</span> // <span class="id" title="lemma">geq_min</span> <span class="id" title="lemma">leqnn</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbT"><span class="id" title="lemma">orbT</span></a>.<br/>
<span class="id" title="var">have</span> := <span class="id" title="var">dfs1_is_correct</span> <span class="id" title="var">_</span> <span class="id" title="var">x_root</span>; <span class="id" title="tactic">rewrite</span> /<a class="idref" href="chip.tarjan.html#dfs1_correct"><span class="id" title="definition">dfs1_correct</span></a>.<br/>
<span class="id" title="tactic">case</span>: (<span class="id" title="var">dfs1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) =&gt; [<span class="id" title="var">m1</span> <span class="id" title="var">e1</span>] <span class="id" title="var">post_dfs1</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; /(<span class="id" title="var">_</span> <span class="id" title="var">e1</span>); <span class="id" title="tactic">case</span>: (<span class="id" title="var">dfsrec'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) =&gt; [<span class="id" title="var">m2</span> <span class="id" title="var">e2</span>] <span class="id" title="var">post_dfs'</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">pre</span> {<span class="id" title="var">dfs1_is_correct</span> <span class="id" title="var">dfs'_is_correct</span>}.<br/>
<span class="id" title="var">have</span> [<span class="id" title="var">e_access_to</span> <span class="id" title="var">e_wf</span> <span class="id" title="var">e_gwf</span> <span class="id" title="var">Nbw</span> <span class="id" title="var">sccs_black</span>] := <span class="id" title="var">pre</span>.<br/>
<span class="id" title="var">have</span> <span class="id" title="var">e_uniq</span> := <a class="idref" href="chip.tarjan.html#wf_stack_uniq"><span class="id" title="projection">wf_stack_uniq</span></a> <span class="id" title="var">e_wf</span>.<br/>
<span class="id" title="var">have</span> <span class="id" title="var">x_white</span> : <span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> <span class="id" title="var">e</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">case</span>: <a class="idref" href="chip.tarjan.html#colorP"><span class="id" title="lemma">colorP</span></a> <span class="id" title="var">xNstack</span> <span class="id" title="var">xNblack</span>.<br/>
<span class="id" title="var">have</span> := <span class="id" title="var">post_dfs1</span> <span class="id" title="var">x_white</span> (<a class="idref" href="chip.tarjan.html#pre_dfs_subroots"><span class="id" title="lemma">pre_dfs_subroots</span></a> <span class="id" title="var">_</span> <span class="id" title="var">pre</span>).<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">sub1set</span> <span class="id" title="var">x_root</span> =&gt; /(<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#isT"><span class="id" title="definition">isT</span></a>) {<span class="id" title="var">post_dfs1</span>}.<br/>
<span class="id" title="tactic">case</span>=&gt; [<span class="id" title="var">x_black</span> [[<span class="id" title="var">e1_wf</span> <span class="id" title="var">e1_gwf</span> <span class="id" title="var">Nbw1</span> <span class="id" title="var">keep_gray</span> <span class="id" title="var">sccs_e1</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[[<span class="id" title="var">s1</span> <span class="id" title="var">s1_def</span> <span class="id" title="var">s1b</span>] <span class="id" title="var">mo_b1</span> <span class="id" title="var">mo_sccs1</span>] [<span class="id" title="var">pc1</span> <span class="id" title="var">pc2</span> <span class="id" title="var">pc3</span>]]].<br/>
<span class="id" title="var">have</span> <span class="id" title="var">e1_uniq</span> := <a class="idref" href="chip.tarjan.html#wf_stack_uniq"><span class="id" title="projection">wf_stack_uniq</span></a> <span class="id" title="var">e1_wf</span>.<br/>
<span class="id" title="tactic">case</span>: <span class="id" title="var">post_dfs'</span>.<br/>
- <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">subCset</span> <span class="id" title="lemma">setCK</span> <span class="id" title="lemma">setUSS</span> // <span class="id" title="var">keep_gray</span>.<br/>
- <span class="id" title="tactic">split</span>=&gt; // <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> <span class="id" title="var">s1_def</span> <span class="id" title="lemma">mem_cat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">case</span>: (<span class="id" title="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="var">s1</span>) (<span class="id" title="lemma">subsetP</span> <span class="id" title="var">s1b</span> <span class="id" title="var">y</span>) =&gt; //= [-&gt;//|<span class="id" title="var">_</span> /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[<span class="id" title="var">yNb</span> <span class="id" title="var">ys</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">z</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span> =&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[<span class="id" title="var">_</span> <span class="id" title="var">z_roots</span>]; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">e_access_to</span> //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> <span class="id" title="var">ys</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andbT"><span class="id" title="lemma">andbT</span></a>; <span class="id" title="tactic">apply</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#contraNN"><span class="id" title="definition">contraNN</span></a> <span class="id" title="var">yNb</span>; <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">subsetP</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">rootsDx_subset</span> [[<span class="id" title="var">e2_wf</span> <span class="id" title="var">e2_gwf</span> <span class="id" title="var">Nbw2</span> <span class="id" title="var">keep_gray2</span> <span class="id" title="var">sccs_e2</span>]<br/>
&nbsp;&nbsp;[[<span class="id" title="var">s2</span> <span class="id" title="var">s2_def</span> <span class="id" title="var">s2b</span>] <span class="id" title="var">mo_b2</span> <span class="id" title="var">mo_sccs2</span>] [<span class="id" title="var">pc21</span> <span class="id" title="var">pc22</span> <span class="id" title="var">pc23</span>]].<br/>
<span class="id" title="var">have</span> <span class="id" title="var">e2_uniq</span> := <a class="idref" href="chip.tarjan.html#wf_stack_uniq"><span class="id" title="projection">wf_stack_uniq</span></a> <span class="id" title="var">e2_wf</span>.<br/>
<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(<span class="id" title="lemma">setD1K</span> <span class="id" title="var">x_root</span>) <span class="id" title="lemma">subUset</span> <span class="id" title="var">rootsDx_subset</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andbT"><span class="id" title="lemma">andbT</span></a> <span class="id" title="lemma">sub1set</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span> (<span class="id" title="lemma">subsetP</span> <span class="id" title="var">mo_b2</span>).<br/>
<span class="id" title="tactic">split</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">keep_gray2</span> <span class="id" title="var">keep_gray</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> (<span class="id" title="var">s2</span> <span class="id" title="notation">++</span> <span class="id" title="var">s1</span>); <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">s2_def</span> <span class="id" title="var">s1_def</span> <span class="id" title="lemma">catA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">subsetP</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mem_cat</span> =&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orP"><span class="id" title="lemma">orP</span></a> [/(<span class="id" title="lemma">subsetP</span> <span class="id" title="var">s2b</span>) //|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">subsetP</span>/(<span class="id" title="lemma">subset_trans</span> <span class="id" title="var">s1b</span>).<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span>/(<span class="id" title="lemma">subset_trans</span> <span class="id" title="var">mo_b1</span>).<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span>/(<span class="id" title="lemma">subset_trans</span> <span class="id" title="var">mo_sccs1</span>).<br/>
<span class="id" title="var">have</span> <span class="id" title="var">m1_rank</span>: <span class="id" title="var">m1</span> <span class="id" title="notation">&lt;=</span> <a class="idref" href="chip.tarjan.html#infty"><span class="id" title="abbreviation">infty</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">case</span>: <span class="id" title="var">pc2</span>=&gt; [-&gt;|[?? [??-&gt;]]]; <span class="id" title="tactic">rewrite</span> ?<a class="idref" href="chip.tarjan.html#rank_le"><span class="id" title="lemma">rank_le</span></a>.<br/>
<span class="id" title="var">have</span> <span class="id" title="var">m2_rank</span>: <span class="id" title="var">m2</span> <span class="id" title="notation">&lt;=</span> <a class="idref" href="chip.tarjan.html#infty"><span class="id" title="abbreviation">infty</span></a> <span class="id" title="tactic">by</span> <span class="id" title="tactic">case</span>: <span class="id" title="var">pc22</span>=&gt; [-&gt;|[?? [??-&gt;]]]; <span class="id" title="tactic">rewrite</span> ?<a class="idref" href="chip.tarjan.html#rank_le"><span class="id" title="lemma">rank_le</span></a>.<br/>
<span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y</span> <span class="id" title="var">y_roots</span>; <span class="id" title="var">have</span> [-&gt;|<span class="id" title="var">neq_yx</span>] := <span class="id" title="lemma">eqVneq</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (@<span class="id" title="lemma">leq_trans</span> <span class="id" title="var">m2</span>) ?<span class="id" title="lemma">geq_minr</span> // <span class="id" title="var">pc21</span> // !<span class="id" title="definition">inE</span> <span class="id" title="var">neq_yx</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">have</span> [<span class="id" title="var">xs</span>|<span class="id" title="var">xNs</span>] := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#boolP"><span class="id" title="lemma">boolP</span></a> (<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">e1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">s2_def</span> <a class="idref" href="chip.tarjan.html#rank_catl"><span class="id" title="lemma">rank_catl</span></a> // (@<span class="id" title="lemma">leq_trans</span> <span class="id" title="var">m1</span>) ?<span class="id" title="lemma">geq_minl</span> // <span class="id" title="var">pc1</span> ?<span class="id" title="definition">inE</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">x_sccs2</span> : <span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="definition">cover</span> (<a class="idref" href="chip.tarjan.html#sccs"><span class="id" title="projection">sccs</span></a> <span class="id" title="var">e2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>: (<span class="id" title="lemma">subsetP</span> (<a class="idref" href="chip.tarjan.html#subset_bigcup"><span class="id" title="lemma">subset_bigcup</span></a> <span class="id" title="var">mo_sccs2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">case</span>: <a class="idref" href="chip.tarjan.html#colorP"><span class="id" title="lemma">colorP</span></a> <span class="id" title="var">xNs</span> <span class="id" title="var">x_black</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#rank_infty"><span class="id" title="lemma">rank_infty</span></a> ?<span class="id" title="lemma">geq_min</span> ?<span class="id" title="var">m1_rank</span> //; <span class="id" title="tactic">case</span>: <a class="idref" href="chip.tarjan.html#colorP"><span class="id" title="lemma">colorP</span></a> <span class="id" title="var">x_sccs2</span>.<br/>
- <span class="id" title="tactic">case</span>: <span class="id" title="var">pc22</span> =&gt; [-&gt;|<span class="id" title="var">m2_reachable</span>].<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">minn_idPl</span> <span class="id" title="var">_</span>) //; <span class="id" title="tactic">case</span>: <span class="id" title="var">pc2</span>=&gt; [-&gt;|<span class="id" title="var">pc2</span>]; [<span class="id" title="tactic">by</span> <span class="id" title="tactic">left</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">case</span>: (<span class="id" title="lemma">ltngtP</span> <span class="id" title="var">m1</span> <span class="id" title="notation">#|</span><a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">|</span>) =&gt; <span class="id" title="var">m1_lt</span> //; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>; <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span> =&gt; //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">case</span>: <span class="id" title="var">pc2</span>=&gt; <span class="id" title="var">z</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span> =&gt; /<span class="id" title="lemma">eqP</span> -&gt; [<span class="id" title="var">t</span> <span class="id" title="var">x_to_t</span> <span class="id" title="var">m1_def</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">exists</span> <span class="id" title="var">t</span> =&gt; //; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">s2_def</span> <a class="idref" href="chip.tarjan.html#rank_catl"><span class="id" title="lemma">rank_catl</span></a> // -<a class="idref" href="chip.tarjan.html#rank_lt"><span class="id" title="lemma">rank_lt</span></a> -?<span class="id" title="var">m1_def</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">case</span>: (<span class="id" title="lemma">leq_ltn_trans</span> <span class="id" title="var">m1_rank</span> <span class="id" title="var">m1_lt</span>); <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">ltnn</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">case</span>: (<span class="id" title="lemma">leqP</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span>) =&gt; [<span class="id" title="var">m12</span>|/<span class="id" title="lemma">ltnW</span> <span class="id" title="var">m21</span>]; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">minn_idPr</span> <span class="id" title="var">_</span>) //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">case</span>: <span class="id" title="var">m2_reachable</span> =&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> =&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[<span class="id" title="var">_</span> <span class="id" title="var">y_root</span>] [<span class="id" title="var">z</span> <span class="id" title="var">y_to_z</span> <span class="id" title="var">m2_def</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">right</span>; <span class="id" title="tactic">exists</span> <span class="id" title="var">y</span> =&gt; //; <span class="id" title="tactic">exists</span> <span class="id" title="var">z</span> =&gt; //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">minn_idPl</span> <span class="id" title="var">_</span>) //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">case</span>: (<span class="id" title="lemma">ltngtP</span> <span class="id" title="var">m1</span> <span class="id" title="notation">#|</span><a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">|</span>) =&gt; <span class="id" title="var">m1_lt</span> //; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>; <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span> =&gt; //; <span class="id" title="tactic">case</span>: <span class="id" title="var">pc2</span>=&gt; [<span class="id" title="var">m1_infty</span>|[<span class="id" title="var">z</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">m1_infty</span> <span class="id" title="lemma">ltnn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">m1_lt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span> =&gt; /<span class="id" title="lemma">eqP</span> -&gt; [<span class="id" title="var">t</span> <span class="id" title="var">x_to_t</span> <span class="id" title="var">m1_def</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">exists</span> <span class="id" title="var">t</span> =&gt; //; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">s2_def</span> <a class="idref" href="chip.tarjan.html#rank_catl"><span class="id" title="lemma">rank_catl</span></a> // -<a class="idref" href="chip.tarjan.html#rank_lt"><span class="id" title="lemma">rank_lt</span></a> -?<span class="id" title="var">m1_def</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">case</span>: (<span class="id" title="lemma">leq_ltn_trans</span> <span class="id" title="var">m1_rank</span> <span class="id" title="var">m1_lt</span>); <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">ltnn</span>.<br/>
- <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> =&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> [<span class="id" title="var">y_s0</span> /<span class="id" title="lemma">existsP</span>[<span class="id" title="var">z</span> /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#and3P"><span class="id" title="lemma">and3P</span></a> [<span class="id" title="var">z_s2</span> <span class="id" title="var">zNs0</span> <span class="id" title="var">z_to_y</span>]]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">z_s2</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">s2_def</span> <span class="id" title="lemma">mem_cat</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbC"><span class="id" title="lemma">orbC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">have</span> [<span class="id" title="var">z_s1</span> <span class="id" title="var">_</span>|/= <span class="id" title="var">zNs1</span> <span class="id" title="var">z_s2</span>] := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#boolP"><span class="id" title="lemma">boolP</span></a> (<span class="id" title="var">z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">e1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#rank_catl"><span class="id" title="lemma">rank_catl</span></a>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">s1_def</span> <span class="id" title="lemma">mem_cat</span> <span class="id" title="var">y_s0</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbT"><span class="id" title="lemma">orbT</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (@<span class="id" title="lemma">leq_trans</span> <span class="id" title="var">m1</span>) ?<span class="id" title="lemma">geq_minl</span> // <span class="id" title="var">pc3</span> // <span class="id" title="definition">inE</span> <span class="id" title="var">y_s0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">existsP</span>; <span class="id" title="tactic">exists</span> <span class="id" title="var">z</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">z_s1</span> <span class="id" title="var">zNs0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="var">s2_def</span> (@<span class="id" title="lemma">leq_trans</span> <span class="id" title="var">m2</span>) ?<span class="id" title="lemma">geq_minr</span> // <span class="id" title="var">pc23</span> // <span class="id" title="definition">inE</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">s1_def</span> <span class="id" title="lemma">mem_cat</span> <span class="id" title="var">y_s0</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbT"><span class="id" title="lemma">orbT</span></a> /=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">existsP</span>; <span class="id" title="tactic">exists</span> <span class="id" title="var">z</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">s2_def</span> <span class="id" title="lemma">mem_cat</span> <span class="id" title="var">z_s2</span> /= [<span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#9ddeac0ab66152bd1d64bedb507a795e"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="chip.tarjan.html#X"><span class="id" title="variable">X</span></a>]<span class="id" title="var">z_to_y</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> -<span class="id" title="var">s1_def</span> <span class="id" title="var">zNs1</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="path_xset_xedge"><span class="id" title="lemma">path_xset_xedge</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span> (<span class="id" title="var">s</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#pred"><span class="id" title="definition">pred</span></a> <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#gconnect"><span class="id" title="abbreviation">gconnect</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">notin</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">x'</span> <span class="id" title="var">y'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b76985613d3b3ca583bb3217c76109bb"><span class="id" title="notation">[/\</span></a> <a class="idref" href="chip.tarjan.html#x'"><span class="id" title="variable">x'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b76985613d3b3ca583bb3217c76109bb"><span class="id" title="notation">,</span></a> <a class="idref" href="chip.tarjan.html#y'"><span class="id" title="variable">y'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">notin</span></a> <a class="idref" href="chip.tarjan.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b76985613d3b3ca583bb3217c76109bb"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#gconnect"><span class="id" title="abbreviation">gconnect</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#x'"><span class="id" title="variable">x'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b76985613d3b3ca583bb3217c76109bb"><span class="id" title="notation">,</span></a> <a class="idref" href="chip.tarjan.html#edge"><span class="id" title="abbreviation">edge</span></a> <a class="idref" href="chip.tarjan.html#x'"><span class="id" title="variable">x'</span></a> <a class="idref" href="chip.tarjan.html#y'"><span class="id" title="variable">y'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b76985613d3b3ca583bb3217c76109bb"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="chip.tarjan.html#gconnect"><span class="id" title="abbreviation">gconnect</span></a> <a class="idref" href="chip.tarjan.html#y'"><span class="id" title="variable">y'</span></a> <a class="idref" href="chip.tarjan.html#y"><span class="id" title="variable">y</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b76985613d3b3ca583bb3217c76109bb"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; /<span class="id" title="lemma">connectP</span> [<span class="id" title="var">p</span> <span class="id" title="var">path_xp</span> -&gt;] <span class="id" title="var">xs</span> <span class="id" title="var">yNs</span>.<br/>
<span class="id" title="tactic">pose</span> <span class="id" title="var">n</span> := <span class="id" title="definition">find</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#predC"><span class="id" title="definition">predC</span></a> <span class="id" title="var">s</span>) <span class="id" title="var">p</span>.<br/>
<span class="id" title="var">have</span> <span class="id" title="var">hasNs_p</span> : <span class="id" title="definition">has</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#predC"><span class="id" title="definition">predC</span></a> <span class="id" title="var">s</span>) <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">hasP</span>; <span class="id" title="tactic">exists</span> (<span class="id" title="definition">last</span> <span class="id" title="var">x</span> <span class="id" title="var">p</span>) =&gt; //=.<br/>
&nbsp;&nbsp;<span class="id" title="var">have</span> := <span class="id" title="lemma">mem_last</span> <span class="id" title="var">x</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">in_cons</span> =&gt; /<span class="id" title="lemma">predU1P</span> [<span class="id" title="var">eq_x</span>|//].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">eq_x</span> <span class="id" title="var">xs</span> <span class="id" title="tactic">in</span> <span class="id" title="var">yNs</span>.<br/>
<span class="id" title="var">have</span> <span class="id" title="var">n_small</span> : <span class="id" title="var">n</span> <span class="id" title="notation">&lt;</span> <span class="id" title="definition">size</span> <span class="id" title="var">p</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> -<span class="id" title="lemma">has_find</span>.<br/>
<span class="id" title="tactic">exists</span> (<span class="id" title="definition">nth</span> <span class="id" title="var">x</span> (<span class="id" title="var">x</span> <span class="id" title="notation">::</span> <span class="id" title="var">p</span>) <span class="id" title="var">n</span>), (<span class="id" title="definition">nth</span> <span class="id" title="var">x</span> <span class="id" title="var">p</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="tactic">rewrite</span> [<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">notin</span></a> <span class="id" title="var">s</span>](@<span class="id" title="lemma">nth_find</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#predC"><span class="id" title="definition">predC</span></a> <span class="id" title="var">s</span>)) ?(<span class="id" title="lemma">pathP</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) //.<br/>
<span class="id" title="var">have</span> [-&gt;|<span class="id" title="var">n_gt0</span>] := <span class="id" title="lemma">posnP</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ?<span class="id" title="lemma">nth0</span> /= <span class="id" title="var">xs</span> <span class="id" title="lemma">connect0</span>; <span class="id" title="tactic">split</span>=&gt; //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">case</span>: <span class="id" title="var">p</span> {<span class="id" title="var">yNs</span> <span class="id" title="var">n</span> <span class="id" title="var">hasNs_p</span> <span class="id" title="var">n_small</span>} <span class="id" title="var">path_xp</span> =&gt; //= <span class="id" title="var">z</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> [<span class="id" title="var">xz</span> <span class="id" title="var">zp</span>]; <span class="id" title="tactic">rewrite</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#appP"><span class="id" title="lemma">appP</span></a> <span class="id" title="lemma">connectP</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#idP"><span class="id" title="lemma">idP</span></a>) //; <span class="id" title="tactic">exists</span> <span class="id" title="var">p</span>.<br/>
<span class="id" title="tactic">rewrite</span> -{1 2}[<span class="id" title="var">n</span>]<span class="id" title="lemma">prednK</span> //= -[<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="var">s</span>]<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#negbK"><span class="id" title="lemma">negbK</span></a>.<br/>
<span class="id" title="tactic">rewrite</span> [<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">notin</span></a> <span class="id" title="var">s</span>](@<span class="id" title="lemma">before_find</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#predC"><span class="id" title="definition">predC</span></a> <span class="id" title="var">s</span>)) ?<span class="id" title="lemma">prednK</span> //=.<br/>
<span class="id" title="tactic">split</span>=&gt; //; <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">connectP</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="definition">take</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>: <span class="id" title="var">path_xp</span>; <span class="id" title="tactic">rewrite</span> -{1}[<span class="id" title="var">p</span>](@<span class="id" title="lemma">cat_take_drop</span> <span class="id" title="var">n</span>) <span class="id" title="lemma">cat_path</span>=&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">last_nth</span> <span class="id" title="var">x</span>) <span class="id" title="lemma">size_take</span> <span class="id" title="var">n_small</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">case</span>: (<span class="id" title="var">n</span>) <span class="id" title="var">n_gt0</span> =&gt; //= <span class="id" title="var">k</span> <span class="id" title="var">_</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">nth_take</span>.<br/>
<span class="id" title="tactic">exists</span> (<span class="id" title="definition">drop</span> <span class="id" title="var">n</span><span class="id" title="notation">.+1</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">path_xp</span>; <span class="id" title="tactic">rewrite</span> -{1}[<span class="id" title="var">p</span>](@<span class="id" title="lemma">cat_take_drop</span> <span class="id" title="var">n</span><span class="id" title="notation">.+1</span>) <span class="id" title="lemma">cat_path</span>=&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[<span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">last_nth</span> <span class="id" title="var">x</span>) /= <span class="id" title="lemma">size_take</span> <span class="id" title="lemma">ltn_neqAle</span> <span class="id" title="var">n_small</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andbT"><span class="id" title="lemma">andbT</span></a>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">have</span> [-&gt;|] := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#altP"><span class="id" title="lemma">altP</span></a> <span class="id" title="lemma">eqP</span>; <span class="id" title="tactic">rewrite</span> /= ?<span class="id" title="lemma">drop_size</span> ?<span class="id" title="lemma">nth_take</span>.<br/>
<span class="id" title="tactic">rewrite</span> !(<span class="id" title="lemma">last_nth</span> <span class="id" title="var">x</span>) <span class="id" title="lemma">size_drop</span>.<br/>
<span class="id" title="tactic">move</span>: <span class="id" title="var">n_small</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">leq_eqVlt</span> =&gt; /<span class="id" title="lemma">predU1P</span>[&lt;-|]; <span class="id" title="tactic">rewrite</span> ?<span class="id" title="lemma">subnn</span> //.<br/>
<span class="id" title="tactic">case</span>: (<span class="id" title="definition">size</span> <span class="id" title="var">p</span>) =&gt; //= - [|<span class="id" title="var">k</span>] //; <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">ltnS</span> =&gt; <span class="id" title="var">n_small</span>.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">subSS</span> <span class="id" title="lemma">subSn</span> // [<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS"><span class="id" title="abbreviation">RHS</span></a>]/= <span class="id" title="lemma">nth_drop</span> <span class="id" title="lemma">addSn</span> <span class="id" title="lemma">subnKC</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="dfs1_is_correct"><span class="id" title="lemma">dfs1_is_correct</span></a> <span class="id" title="var">dfs'</span> (<span class="id" title="var">x</span> : <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a>) <span class="id" title="var">e</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#dfs'_correct"><span class="id" title="definition">dfs'_correct</span></a> <a class="idref" href="chip.tarjan.html#dfs'"><span class="id" title="variable">dfs'</span></a> <span class="id" title="notation">[</span><span class="id" title="notation">set</span> <span class="id" title="var">y</span> <span class="id" title="notation">in</span> <a class="idref" href="chip.tarjan.html#tarjan.successors"><span class="id" title="variable">successors</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a><span class="id" title="notation">]</span> (<a class="idref" href="chip.tarjan.html#add_stack"><span class="id" title="definition">add_stack</span></a> <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#dfs1_correct"><span class="id" title="definition">dfs1_correct</span></a> (<a class="idref" href="chip.tarjan.html#dfs1"><span class="id" title="definition">dfs1</span></a> <a class="idref" href="chip.tarjan.html#dfs'"><span class="id" title="variable">dfs'</span></a>) <a class="idref" href="chip.tarjan.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">rewrite</span> /<a class="idref" href="chip.tarjan.html#dfs1"><span class="id" title="definition">dfs1</span></a> /<a class="idref" href="chip.tarjan.html#dfs1_correct"><span class="id" title="definition">dfs1_correct</span></a> /<a class="idref" href="chip.tarjan.html#dfs'_correct"><span class="id" title="definition">dfs'_correct</span></a>; <span class="id" title="tactic">case</span>: (<span class="id" title="var">dfs'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) =&gt; <span class="id" title="var">m1</span> <span class="id" title="var">e1</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">post_dfs'</span>; <span class="id" title="tactic">set</span> <span class="id" title="var">m</span> := <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <span class="id" title="var">x</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">x_white</span> [<span class="id" title="var">access_to_x</span> <span class="id" title="var">e_wf</span> <span class="id" title="var">e_gwf</span> <span class="id" title="var">Nbw</span> <span class="id" title="var">black_sccs</span>].<br/>
<span class="id" title="var">have</span> <span class="id" title="var">e_uniq</span> := <a class="idref" href="chip.tarjan.html#wf_stack_uniq"><span class="id" title="projection">wf_stack_uniq</span></a> <span class="id" title="var">e_wf</span>.<br/>
<span class="id" title="tactic">case</span>: <span class="id" title="var">post_dfs'</span> =&gt; //=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span> =&gt; //; <span class="id" title="tactic">do</span>?[<span class="id" title="tactic">exact</span>: <a class="idref" href="chip.tarjan.html#add_stack_ewf"><span class="id" title="lemma">add_stack_ewf</span></a>|<span class="id" title="tactic">exact</span>: <a class="idref" href="chip.tarjan.html#add_stack_gwf"><span class="id" title="lemma">add_stack_gwf</span></a>]; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y</span> /<span class="id" title="var">Nbw</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#whites_add_stack"><span class="id" title="lemma">whites_add_stack</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ![<span class="id" title="notation">[</span><span class="id" title="notation">disjoint</span> <a class="idref" href="chip.tarjan.html#tarjan.successors"><span class="id" title="variable">successors</span></a> <span class="id" title="var">_</span> <span class="id" title="notation">&amp;</span> <span class="id" title="var">_</span><span class="id" title="notation">]</span>]<span class="id" title="lemma">disjoint_sym</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">disjoint_trans</span>/<span class="id" title="lemma">subsetDl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#grays_add_stack"><span class="id" title="lemma">grays_add_stack</span></a> // =&gt; /<span class="id" title="lemma">setU1P</span> [-&gt;|]; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y_gray</span> <span class="id" title="var">z</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span> =&gt; /(@<span class="id" title="lemma">connect1</span> <span class="id" title="var">_</span> <a class="idref" href="chip.tarjan.html#edge"><span class="id" title="abbreviation">edge</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">connect_trans</span>/<span class="id" title="var">access_to_x</span>; <span class="id" title="tactic">rewrite</span> ?<span class="id" title="lemma">set11</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">z</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span> =&gt; /(@<span class="id" title="lemma">connect1</span> <span class="id" title="var">_</span> <a class="idref" href="chip.tarjan.html#edge"><span class="id" title="abbreviation">edge</span></a>).<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">succ_bVg</span> [[<span class="id" title="var">e1_wf</span> <span class="id" title="var">e1_gwf</span> <span class="id" title="var">Nbw1</span> <span class="id" title="var">keep_gray</span> <span class="id" title="var">black_sccs1</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[[<span class="id" title="var">s</span>/= <span class="id" title="var">s_def</span> <span class="id" title="var">sb</span>] <span class="id" title="var">mo_b</span> <span class="id" title="var">mo_sccs</span>] [<span class="id" title="var">pc1</span> <span class="id" title="var">pc2</span> <span class="id" title="var">pc3</span>]].<br/>
<span class="id" title="tactic">set</span> <span class="id" title="var">s2</span> := <span class="id" title="definition">rcons</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span>.<br/>
<span class="id" title="var">have</span> <span class="id" title="var">e1_uniq</span> := <a class="idref" href="chip.tarjan.html#wf_stack_uniq"><span class="id" title="projection">wf_stack_uniq</span></a> <span class="id" title="var">e1_wf</span>.<br/>
<span class="id" title="var">have</span> <span class="id" title="var">xe_uniq</span> : <span class="id" title="definition">uniq</span> (<span class="id" title="var">x</span> <span class="id" title="notation">::</span> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">e</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">have</span> := <span class="id" title="var">e1_uniq</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">s_def</span> <span class="id" title="lemma">cat_uniq</span> =&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#and3P"><span class="id" title="lemma">and3P</span></a> [].<br/>
<span class="id" title="var">have</span> <span class="id" title="var">x_stack</span> : <span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">e1</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">s_def</span> <span class="id" title="lemma">mem_cat</span> <span class="id" title="lemma">mem_head</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbT"><span class="id" title="lemma">orbT</span></a>.<br/>
<span class="id" title="var">have</span> <span class="id" title="var">x_grays</span> : <span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <span class="id" title="var">e1</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">keep_gray</span> <a class="idref" href="chip.tarjan.html#grays_add_stack"><span class="id" title="lemma">grays_add_stack</span></a> ?<span class="id" title="lemma">setU11</span>.<br/>
<span class="id" title="var">have</span> <span class="id" title="var">sx_subscc</span> : <a class="idref" href="chip.tarjan.html#is_subscc"><span class="id" title="definition">is_subscc</span></a> <span class="id" title="notation">[</span><span class="id" title="notation">set</span> <span class="id" title="var">y</span> <span class="id" title="notation">in</span> <span class="id" title="definition">rcons</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span><span class="id" title="notation">]</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span>: (@<a class="idref" href="chip.tarjan.html#is_subscc1"><span class="id" title="lemma">is_subscc1</span></a> <span class="id" title="var">x</span>); <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span> <span class="id" title="lemma">mem_rcons</span> <span class="id" title="lemma">mem_head</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> <span class="id" title="lemma">mem_rcons</span> <span class="id" title="lemma">in_cons</span> =&gt; /<span class="id" title="lemma">predU1P</span> [-&gt;//|<span class="id" title="var">y_s</span>]; <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>: (@<a class="idref" href="chip.tarjan.html#wf_grays_to_stack"><span class="id" title="projection">wf_grays_to_stack</span></a> <span class="id" title="var">e1</span>) =&gt; //; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">s_def</span> <span class="id" title="lemma">mem_cat</span> <span class="id" title="var">y_s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">s_def</span> <a class="idref" href="chip.tarjan.html#rank_catl"><span class="id" title="lemma">rank_catl</span></a> ?<span class="id" title="lemma">mem_head</span> // <a class="idref" href="chip.tarjan.html#rank_catr"><span class="id" title="lemma">rank_catr</span></a> //=; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> -(@<a class="idref" href="chip.tarjan.html#uniq_catLR"><span class="id" title="lemma">uniq_catLR</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">s</span>) ?<span class="id" title="lemma">mem_cat</span> ?<span class="id" title="var">y_s</span> // -?<span class="id" title="var">s_def</span> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#rankE"><span class="id" title="lemma">rankE</span></a> <span class="id" title="lemma">mem_head</span> (<span class="id" title="lemma">leq_trans</span> (<span class="id" title="lemma">index_size</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">size_rev</span> <span class="id" title="lemma">leq_addr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">have</span> [] := @<a class="idref" href="chip.tarjan.html#wf_stack_to_grays"><span class="id" title="projection">wf_stack_to_grays</span></a> <span class="id" title="var">_</span> <span class="id" title="var">e1_gwf</span> <span class="id" title="var">y</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">s_def</span> <span class="id" title="lemma">mem_cat</span> <span class="id" title="var">y_s</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">z</span> [<span class="id" title="var">z_gray</span> <span class="id" title="var">rank_z</span>] /<span class="id" title="lemma">connect_trans</span>; <span class="id" title="tactic">apply</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (@<a class="idref" href="chip.tarjan.html#wf_grays_to_stack"><span class="id" title="projection">wf_grays_to_stack</span></a> <span class="id" title="var">e1</span>) // <span class="id" title="var">s_def</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">have</span> := <span class="id" title="var">z_gray</span>; <span class="id" title="tactic">rewrite</span> !<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="definition">inE</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">s_def</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="lemma">mem_cat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">case</span>: (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#boolP"><span class="id" title="lemma">boolP</span></a> (<span class="id" title="var">z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="var">s</span>)) =&gt; [/(<span class="id" title="lemma">subsetP</span> <span class="id" title="var">sb</span>)-&gt;//|<span class="id" title="var">_</span> /= /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> [<span class="id" title="var">_</span> <span class="id" title="var">z_xe</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<a class="idref" href="chip.tarjan.html#rank_catl"><span class="id" title="lemma">rank_catl</span></a> ?<span class="id" title="lemma">mem_head</span> //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">z_xe</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">in_cons</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">have</span> [-&gt;//|<span class="id" title="var">neq_zx</span> /= <span class="id" title="var">z_s</span>] := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#altP"><span class="id" title="lemma">altP</span></a> <span class="id" title="lemma">eqP</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">ltnW</span> // <a class="idref" href="chip.tarjan.html#rank_le_head"><span class="id" title="lemma">rank_le_head</span></a> //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(@<a class="idref" href="chip.tarjan.html#uniq_catLR"><span class="id" title="lemma">uniq_catLR</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="definition">rcons</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span>)) ?<span class="id" title="lemma">mem_rcons</span> ?<span class="id" title="lemma">mem_head</span> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">cat_rcons</span> -<span class="id" title="var">s_def</span> <a class="idref" href="chip.tarjan.html#wf_stack_uniq"><span class="id" title="projection">wf_stack_uniq</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mem_cat</span> <span class="id" title="lemma">mem_rcons</span> <span class="id" title="lemma">mem_head</span>.<br/>
<span class="id" title="tactic">case</span>: <span class="id" title="lemma">ltnP</span> =&gt; [<span class="id" title="var">m1_small</span>|<span class="id" title="var">m1_big</span>] //=; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> <span class="id" title="abbreviation">eqxx</span> /=; <span class="id" title="tactic">split</span>=&gt; //.<br/>
&nbsp;&nbsp;<span class="id" title="var">have</span> [<span class="id" title="var">x1</span> <span class="id" title="var">rank_x1</span> <span class="id" title="var">x_to_x1</span>] : <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#3df228c109f14f0423b4fccc967ee1ac"><span class="id" title="notation">exists2</span></a> <span class="id" title="var">x1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#3df228c109f14f0423b4fccc967ee1ac"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#x1"><span class="id" title="variable">x1</span></a> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">e1</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">m1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#3df228c109f14f0423b4fccc967ee1ac"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="chip.tarjan.html#gconnect"><span class="id" title="abbreviation">gconnect</span></a> <span class="id" title="var">x</span> <a class="idref" href="chip.tarjan.html#x1"><span class="id" title="variable">x1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">case</span>: <span class="id" title="var">pc2</span> <span class="id" title="var">m1_small</span> =&gt; [-&gt;|]; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> /<span class="id" title="var">m</span> <span class="id" title="lemma">ltnNge</span> ?<a class="idref" href="chip.tarjan.html#rank_le"><span class="id" title="lemma">rank_le</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; [<span class="id" title="var">y</span>]; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span> =&gt; /(@<span class="id" title="lemma">connect1</span> <span class="id" title="var">_</span> <a class="idref" href="chip.tarjan.html#edge"><span class="id" title="abbreviation">edge</span></a>) <span class="id" title="var">x_to_y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; [<span class="id" title="var">x1</span> <span class="id" title="var">y_to_x1</span> <span class="id" title="var">rank_x1</span> <span class="id" title="var">_</span>]; <span class="id" title="tactic">exists</span> <span class="id" title="var">x1</span> =&gt; //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">connect_trans</span> <span class="id" title="var">x_to_y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">have</span> [<span class="id" title="var">x'</span> [<span class="id" title="var">rank_x'</span> <span class="id" title="var">x'_gray</span> <span class="id" title="var">x_to_x'</span> ]] : <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <span class="id" title="var">x'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">[/\</span></a> <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <a class="idref" href="chip.tarjan.html#x'"><span class="id" title="variable">x'</span></a> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">e1</span>) <span class="id" title="notation">&lt;</span> <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <span class="id" title="var">x</span> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">e1</span>)<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">,</span></a> <a class="idref" href="chip.tarjan.html#x'"><span class="id" title="variable">x'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <span class="id" title="var">e1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="chip.tarjan.html#gconnect"><span class="id" title="abbreviation">gconnect</span></a> <span class="id" title="var">x</span> <a class="idref" href="chip.tarjan.html#x'"><span class="id" title="variable">x'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#d7e433f5d2fe56f5b712860a9ff2a681"><span class="id" title="notation">]</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">m1_small</span>; <span class="id" title="tactic">rewrite</span> -{}<span class="id" title="var">rank_x1</span> =&gt; <span class="id" title="var">rank_x1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">x1_stack</span> : <span class="id" title="var">x1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">e1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> -<a class="idref" href="chip.tarjan.html#rank_lt"><span class="id" title="lemma">rank_lt</span></a> ?(<span class="id" title="lemma">leq_trans</span> <span class="id" title="var">rank_x1</span>) // <a class="idref" href="chip.tarjan.html#rank_le"><span class="id" title="lemma">rank_le</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> [<span class="id" title="var">z</span> [<span class="id" title="var">z_gray</span> <span class="id" title="var">rank_z</span> <span class="id" title="var">y_to_z</span>]] := <a class="idref" href="chip.tarjan.html#wf_stack_to_grays"><span class="id" title="projection">wf_stack_to_grays</span></a> <span class="id" title="var">e1_gwf</span> <span class="id" title="var">x1_stack</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">z</span>; <span class="id" title="tactic">split</span>=&gt; //; <span class="id" title="tactic">rewrite</span> 2?<span class="id" title="definition">inE</span> ?<span class="id" title="var">z_gray</span> ?<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andbT"><span class="id" title="lemma">andbT</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">leq_ltn_trans</span> <span class="id" title="var">rank_z</span>) // (<span class="id" title="lemma">leq_trans</span> <span class="id" title="var">rank_x1</span>) // /<span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">s_def</span> <a class="idref" href="chip.tarjan.html#rank_catl"><span class="id" title="lemma">rank_catl</span></a> ?<span class="id" title="lemma">mem_head</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">connect_trans</span> <span class="id" title="var">x_to_x1</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">neq_x'x</span> : <span class="id" title="var">x'</span> <span class="id" title="notation">!=</span> <span class="id" title="var">x</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>: <span class="id" title="lemma">contraTneq</span> <span class="id" title="var">rank_x'</span> =&gt; -&gt;; <span class="id" title="tactic">rewrite</span> -<span class="id" title="lemma">ltnNge</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>=&gt; //.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">split</span>=&gt; //; <span class="id" title="tactic">first</span> <span class="id" title="tactic">exact</span>: <a class="idref" href="chip.tarjan.html#add_blacks_ewf"><span class="id" title="lemma">add_blacks_ewf</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span> =&gt; //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y</span> <span class="id" title="var">z</span> /=; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#grays_add_blacks"><span class="id" title="lemma">grays_add_blacks</span></a> =&gt; <span class="id" title="var">y_gray</span> <span class="id" title="var">z_stack</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>: <a class="idref" href="chip.tarjan.html#wf_grays_to_stack"><span class="id" title="projection">wf_grays_to_stack</span></a> =&gt; //; <span class="id" title="tactic">apply</span>: <span class="id" title="lemma">subsetP</span> <span class="id" title="var">y_gray</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">subD1set</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y</span> /= <span class="id" title="var">y_stack</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#grays_add_blacks"><span class="id" title="lemma">grays_add_blacks</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> [<span class="id" title="var">z</span>] // := <a class="idref" href="chip.tarjan.html#wf_stack_to_grays"><span class="id" title="projection">wf_stack_to_grays</span></a> <span class="id" title="var">e1_gwf</span> <span class="id" title="var">y_stack</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> [-&gt;{<span class="id" title="var">z</span>} [<span class="id" title="var">_</span> <span class="id" title="var">rank_x</span> <span class="id" title="var">y_to_x</span>]|] := <span class="id" title="lemma">eqVneq</span> <span class="id" title="var">z</span> <span class="id" title="var">x</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">neq_zx</span> [<span class="id" title="var">z_gray</span> <span class="id" title="var">rank_z</span> <span class="id" title="var">y_to_z</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">exists</span> <span class="id" title="var">z</span>; <span class="id" title="tactic">split</span>=&gt; //; <span class="id" title="tactic">rewrite</span> 2!<span class="id" title="definition">inE</span> <span class="id" title="var">neq_zx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">x'</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">rewrite</span> 2?<span class="id" title="definition">inE</span> ?<span class="id" title="var">x'_gray</span> ?<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andbT"><span class="id" title="lemma">andbT</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">leq_trans</span> <span class="id" title="var">_</span> <span class="id" title="var">rank_x</span>) 1?<span class="id" title="lemma">ltnW</span> // {2}<span class="id" title="var">s_def</span> <a class="idref" href="chip.tarjan.html#rank_catl"><span class="id" title="lemma">rank_catl</span></a> ?<span class="id" title="lemma">mem_head</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">connect_trans</span> <span class="id" title="var">y_to_x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> <a class="idref" href="chip.tarjan.html#whites_add_blacks"><span class="id" title="lemma">whites_add_blacks</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; /<span class="id" title="lemma">predU1P</span> [-&gt;{<span class="id" title="var">y</span>}|<span class="id" title="var">y_black</span>]; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">pred0P</span>=&gt; <span class="id" title="var">z</span> /=; <span class="id" title="tactic">rewrite</span> 2!<span class="id" title="definition">inE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> /<span class="id" title="lemma">pred0P</span> /(<span class="id" title="var">_</span> <span class="id" title="var">z</span>) /= := <span class="id" title="var">Nbw1</span> <span class="id" title="var">_</span> <span class="id" title="var">y_black</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#contraFF"><span class="id" title="lemma">contraFF</span></a>=&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#and3P"><span class="id" title="lemma">and3P</span></a>[-&gt;<span class="id" title="var">_</span>-&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">pred0P</span>=&gt; <span class="id" title="var">z</span> /=; <span class="id" title="tactic">rewrite</span> 2!<span class="id" title="definition">inE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> /<span class="id" title="lemma">subsetP</span> /(<span class="id" title="var">_</span> <span class="id" title="var">z</span>) := <span class="id" title="var">succ_bVg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2!<span class="id" title="definition">inE</span> =&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#implyP"><span class="id" title="lemma">implyP</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">case</span>: (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#tarjan.successors"><span class="id" title="variable">successors</span></a> <span class="id" title="var">_</span>) (<span class="id" title="var">_</span> <span class="id" title="notation">==</span> <span class="id" title="var">_</span>) <a class="idref" href="chip.tarjan.html#colorP"><span class="id" title="lemma">colorP</span></a> =&gt; [] [] [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#grays_add_blacks"><span class="id" title="lemma">grays_add_blacks</span></a> <span class="id" title="var">keep_gray</span> <a class="idref" href="chip.tarjan.html#grays_add_stack"><span class="id" title="lemma">grays_add_stack</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">setU1K</span> // <a class="idref" href="chip.tarjan.html#whites_graysF"><span class="id" title="lemma">whites_graysF</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> /= <span class="id" title="var">black_sccs1</span>; <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">setP</span>=&gt; <span class="id" title="var">scc</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> [<span class="id" title="var">scc_gsccs</span>|] //= := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#boolP"><span class="id" title="lemma">boolP</span></a> (<span class="id" title="var">scc</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#gsccs"><span class="id" title="definition">gsccs</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#idP"><span class="id" title="lemma">idP</span></a>/<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#idP"><span class="id" title="lemma">idP</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; /<span class="id" title="lemma">subset_trans</span>; <span class="id" title="tactic">apply</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">subsetU1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; /<span class="id" title="lemma">subsetP</span> <span class="id" title="var">scc_sub</span>; <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">subsetP</span> =&gt; <span class="id" title="var">y</span> <span class="id" title="var">y_scc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> /<span class="id" title="lemma">setU1P</span> [<span class="id" title="var">eq_yx</span>|//] := <span class="id" title="var">scc_sub</span> <span class="id" title="var">y</span> <span class="id" title="var">y_scc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">eq_yx</span> <span class="id" title="tactic">in</span> <span class="id" title="var">y_scc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">x'_scc</span> : (<span class="id" title="var">x'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="var">scc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(<a class="idref" href="chip.tarjan.html#def_scc"><span class="id" title="definition">def_scc</span></a> <span class="id" title="var">_</span> <span class="id" title="var">y_scc</span>) // <a class="idref" href="chip.tarjan.html#mem_scc"><span class="id" title="lemma">mem_scc</span></a> /= <span class="id" title="var">x_to_x'</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (<a class="idref" href="chip.tarjan.html#wf_grays_to_stack"><span class="id" title="projection">wf_grays_to_stack</span></a> <span class="id" title="var">e1_gwf</span>) // <span class="id" title="lemma">ltnW</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> /<span class="id" title="var">scc_sub</span> := <span class="id" title="var">x'_scc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#negPf"><span class="id" title="lemma">negPf</span></a> <span class="id" title="var">neq_x'x</span>) /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">case</span>: <a class="idref" href="chip.tarjan.html#colorP"><span class="id" title="lemma">colorP</span></a> <span class="id" title="var">x'_gray</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">split</span>=&gt; //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> (<span class="id" title="definition">rcons</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span>); <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">cat_rcons</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">subsetP</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> <span class="id" title="lemma">mem_rcons</span> <span class="id" title="lemma">in_cons</span>=&gt; /<span class="id" title="lemma">predU1P</span> [-&gt;|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="abbreviation">eqxx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y_s</span>; <span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">subsetP</span> <span class="id" title="var">sb</span>) ?<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbT"><span class="id" title="lemma">orbT</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">subsetU</span> // <span class="id" title="var">mo_b</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbT"><span class="id" title="lemma">orbT</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">split</span>=&gt; //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span> =&gt; /<span class="id" title="lemma">eqP</span>-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">s_def</span> <a class="idref" href="chip.tarjan.html#rank_catl"><span class="id" title="lemma">rank_catl</span></a> ?<span class="id" title="lemma">mem_head</span> // <span class="id" title="lemma">ltnW</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">by</span> <span class="id" title="tactic">right</span>; <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">rewrite</span> ?<span class="id" title="lemma">set11</span> //; <span class="id" title="tactic">exists</span> <span class="id" title="var">x1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span> =&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> [<span class="id" title="var">y_stack</span> /<span class="id" title="lemma">existsP</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; [<span class="id" title="var">z</span> /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#and3P"><span class="id" title="lemma">and3P</span></a>[<span class="id" title="var">z_stack1</span> <span class="id" title="var">zNstack</span> <span class="id" title="var">zy</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> [<span class="id" title="var">eq_zx</span>|<span class="id" title="var">neq_zx</span>] := <span class="id" title="lemma">eqVneq</span> <span class="id" title="var">z</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">pc1</span> // -<span class="id" title="var">eq_zx</span> <span class="id" title="definition">inE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>: <span class="id" title="var">pc3</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span> <span class="id" title="lemma">in_cons</span> <span class="id" title="var">y_stack</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbT"><span class="id" title="lemma">orbT</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">existsP</span>; <span class="id" title="tactic">exists</span> <span class="id" title="var">z</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">z_stack1</span> <span class="id" title="lemma">in_cons</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#negb_or"><span class="id" title="lemma">negb_or</span></a> <span class="id" title="var">neq_zx</span> <span class="id" title="var">zNstack</span>.<br/>
<span class="id" title="var">have</span> <span class="id" title="var">scc_max</span> : <a class="idref" href="chip.tarjan.html#scc_of"><span class="id" title="abbreviation">scc_of</span></a> <span class="id" title="var">x</span> <span class="id" title="notation">\</span><span class="id" title="notation">subset</span> <span class="id" title="notation">[</span><span class="id" title="notation">set</span> <span class="id" title="var">y</span> <span class="id" title="notation">in</span> <span class="id" title="var">s2</span><span class="id" title="notation">]</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">subsetP</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span>=&gt; <span class="id" title="var">y_sccx</span>; <span class="id" title="tactic">apply</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#contraTT"><span class="id" title="definition">contraTT</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#isT"><span class="id" title="definition">isT</span></a> =&gt; <span class="id" title="var">yNs2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">xy</span> : <a class="idref" href="chip.tarjan.html#gconnect"><span class="id" title="abbreviation">gconnect</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">have</span> := <span class="id" title="var">y_sccx</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#mem_scc"><span class="id" title="lemma">mem_scc</span></a> /= =&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[].<br/>
&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">x_s2</span> : <span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="var">s2</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mem_rcons</span> <span class="id" title="lemma">mem_head</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">have</span> [<span class="id" title="var">x'</span> [<span class="id" title="var">y'</span> [<span class="id" title="var">x'_s2</span> <span class="id" title="var">y'Ns</span> <span class="id" title="var">xx'</span> <span class="id" title="var">x'y'</span> <span class="id" title="var">y'y</span>]]] := <a class="idref" href="chip.tarjan.html#path_xset_xedge"><span class="id" title="lemma">path_xset_xedge</span></a> <span class="id" title="var">xy</span> <span class="id" title="var">x_s2</span> <span class="id" title="var">yNs2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#contraNN"><span class="id" title="definition">contraNN</span></a> <span class="id" title="var">y'Ns</span> =&gt; <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">have</span>: <span class="id" title="var">y'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">(</span></a><span class="id" title="notation">[</span><span class="id" title="notation">set</span> <span class="id" title="var">y</span> <span class="id" title="notation">in</span> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">e1</span><span class="id" title="notation">]</span> <span class="id" title="notation">:|:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">\</span><span class="id" title="notation">bigcup_</span><span class="id" title="notation">(</span><span class="id" title="var">scc</span> <span class="id" title="notation">in</span> <a class="idref" href="chip.tarjan.html#sccs"><span class="id" title="projection">sccs</span></a> <span class="id" title="var">e1</span><span class="id" title="notation">)</span> <a class="idref" href="chip.tarjan.html#scc"><span class="id" title="variable">scc</span></a> <span class="id" title="notation">:|:</span> <a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> <span class="id" title="var">e1</span><span class="id" title="notation">)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span>; <span class="id" title="tactic">case</span>: <a class="idref" href="chip.tarjan.html#colorP"><span class="id" title="lemma">colorP</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 3!<span class="id" title="definition">inE</span> =&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#or3P"><span class="id" title="lemma">or3P</span></a>[].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">s_def</span> -<span class="id" title="lemma">cat_rcons</span> <span class="id" title="lemma">mem_cat</span> =&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orP"><span class="id" title="lemma">orP</span></a>[//|<span class="id" title="var">y'_stack</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">xNstack</span>: <span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">notin</span></a> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(@<a class="idref" href="chip.tarjan.html#uniq_catLR"><span class="id" title="lemma">uniq_catLR</span></a> <span class="id" title="var">_</span> <span class="id" title="var">x</span> <span class="id" title="var">s2</span>) ?<span class="id" title="lemma">mem_cat</span> ?<span class="id" title="var">x_s2</span> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">cat_rcons</span> -<span class="id" title="var">s_def</span> <a class="idref" href="chip.tarjan.html#wf_stack_uniq"><span class="id" title="projection">wf_stack_uniq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">x'Nstack</span>: <span class="id" title="var">x'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#c1ad6bcc76a6221225111f87bc3b0c3d"><span class="id" title="notation">notin</span></a> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(@<a class="idref" href="chip.tarjan.html#uniq_catLR"><span class="id" title="lemma">uniq_catLR</span></a> <span class="id" title="var">_</span> <span class="id" title="var">x'</span> <span class="id" title="var">s2</span>) ?<span class="id" title="lemma">mem_cat</span> ?<span class="id" title="var">x'_s2</span> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">cat_rcons</span> -<span class="id" title="var">s_def</span> <a class="idref" href="chip.tarjan.html#wf_stack_uniq"><span class="id" title="projection">wf_stack_uniq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">rank_y'</span>: <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <span class="id" title="var">y'</span> (<span class="id" title="var">x</span> <span class="id" title="notation">::</span> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">e</span>) <span class="id" title="notation">&lt;</span> <a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <span class="id" title="var">x</span> (<span class="id" title="var">x</span> <span class="id" title="notation">::</span> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">e</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#rank_le_head"><span class="id" title="lemma">rank_le_head</span></a> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">neq_y'x</span> : <span class="id" title="var">y'</span> <span class="id" title="notation">!=</span> <span class="id" title="var">x</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>: <span class="id" title="lemma">contraTneq</span> <span class="id" title="var">rank_y'</span> =&gt; -&gt;; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">ltnn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> [<span class="id" title="var">eq_x'x</span>|<span class="id" title="var">neq_x'x</span>] := <span class="id" title="lemma">eqVneq</span> <span class="id" title="var">x'</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> := <span class="id" title="var">pc1</span> <span class="id" title="var">y'</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span> -<span class="id" title="var">eq_x'x</span> =&gt; /(<span class="id" title="var">_</span> <span class="id" title="var">x'y'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">leqNgt</span> (<span class="id" title="lemma">leq_trans</span> <span class="id" title="var">_</span> <span class="id" title="var">m1_big</span>) // /<span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">s_def</span> <a class="idref" href="chip.tarjan.html#rank_catl"><span class="id" title="lemma">rank_catl</span></a> ?<span class="id" title="lemma">in_cons</span> ?<span class="id" title="var">y'_stack</span> ?<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbT"><span class="id" title="lemma">orbT</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#contraTT"><span class="id" title="definition">contraTT</span></a> <span class="id" title="var">rank_y'</span> =&gt; <span class="id" title="var">y'Ns2</span>; <span class="id" title="tactic">rewrite</span> -<span class="id" title="lemma">leqNgt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> [<a class="idref" href="chip.tarjan.html#rank"><span class="id" title="definition">rank</span></a> <span class="id" title="var">y'</span> <span class="id" title="var">_</span>]<a class="idref" href="chip.tarjan.html#rank_cons"><span class="id" title="lemma">rank_cons</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#negPf"><span class="id" title="lemma">negPf</span></a> <span class="id" title="var">neq_y'x</span>) /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> := <span class="id" title="var">pc3</span> <span class="id" title="var">y'</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span> <span class="id" title="lemma">in_cons</span> <span class="id" title="var">y'_stack</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbT"><span class="id" title="lemma">orbT</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> {2}<span class="id" title="var">s_def</span> -<span class="id" title="lemma">cat_rcons</span> <a class="idref" href="chip.tarjan.html#rank_catl"><span class="id" title="lemma">rank_catl</span></a> // =&gt; /(<span class="id" title="var">_</span> <span class="id" title="var">_</span>) /(<span class="id" title="lemma">leq_trans</span> <span class="id" title="var">_</span>) -&gt; //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">existsP</span>; <span class="id" title="tactic">exists</span> <span class="id" title="var">x'</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">s_def</span> -<span class="id" title="lemma">cat_rcons</span> <span class="id" title="lemma">mem_cat</span> <span class="id" title="var">x'_s2</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">in_cons</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#negPf"><span class="id" title="lemma">negPf</span></a> <span class="id" title="var">neq_x'x</span>) /= <span class="id" title="var">x'Nstack</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">move</span>=&gt; /<span class="id" title="lemma">bigcupP</span> [<span class="id" title="var">scc'</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">black_sccs1</span> <span class="id" title="definition">inE</span> =&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[<span class="id" title="var">scc'_gsccs</span> <span class="id" title="var">scc'_black</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; /<a class="idref" href="chip.tarjan.html#def_scc"><span class="id" title="definition">def_scc</span></a> - /(<span class="id" title="var">_</span> <span class="id" title="var">scc'_gsccs</span>) <span class="id" title="var">eq_scc'</span>; <span class="id" title="tactic">rewrite</span> -<span class="id" title="var">eq_scc'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">scc'_black</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> : <span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#scc_of"><span class="id" title="abbreviation">scc_of</span></a> <span class="id" title="var">y'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span>:= <span class="id" title="var">y_sccx</span>; <span class="id" title="tactic">rewrite</span> !<a class="idref" href="chip.tarjan.html#mem_scc"><span class="id" title="lemma">mem_scc</span></a> /= <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andbC"><span class="id" title="lemma">andbC</span></a> =&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[<span class="id" title="var">yx</span> <span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">connect_trans</span> <span class="id" title="var">y'y</span>) //= (<span class="id" title="lemma">connect_trans</span> <span class="id" title="var">xx'</span>) //= <span class="id" title="lemma">connect1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; /(<span class="id" title="lemma">subsetP</span> <span class="id" title="var">scc'_black</span>); <span class="id" title="tactic">case</span>: <a class="idref" href="chip.tarjan.html#colorP"><span class="id" title="lemma">colorP</span></a> <span class="id" title="var">x_grays</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">move</span>: <span class="id" title="var">x'_s2</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mem_rcons</span> <span class="id" title="lemma">in_cons</span> =&gt; /<span class="id" title="lemma">predU1P</span> [<span class="id" title="var">eq_x'x</span>|<span class="id" title="var">x_s</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> /<span class="id" title="lemma">subsetP</span> /(<span class="id" title="var">_</span> <span class="id" title="var">y'</span>) := <span class="id" title="var">succ_bVg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> 2!<span class="id" title="definition">inE</span> -<span class="id" title="var">eq_x'x</span> =&gt; /(<span class="id" title="var">_</span> <span class="id" title="var">x'y'</span>); <span class="id" title="tactic">case</span>: <a class="idref" href="chip.tarjan.html#colorP"><span class="id" title="lemma">colorP</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> /(<span class="id" title="var">_</span> <span class="id" title="var">x'</span>) := <span class="id" title="var">Nbw1</span>; <span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">subsetP</span> <span class="id" title="var">sb</span>) =&gt; // /(<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#isT"><span class="id" title="definition">isT</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; /<span class="id" title="lemma">pred0P</span> /(<span class="id" title="var">_</span> <span class="id" title="var">y'</span>) /=; <span class="id" title="tactic">rewrite</span> [<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="var">_</span>]<span class="id" title="var">x'y'</span> /= =&gt; -&gt;.<br/>
<span class="id" title="var">have</span> <span class="id" title="var">take_s</span> : <span class="id" title="definition">take</span> (<span class="id" title="definition">index</span> <span class="id" title="var">x</span> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">e1</span>)) (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">e1</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">s_def</span> <span class="id" title="lemma">index_cat</span> /= <span class="id" title="abbreviation">eqxx</span> <span class="id" title="lemma">addn0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (@<a class="idref" href="chip.tarjan.html#uniq_catLR"><span class="id" title="lemma">uniq_catLR</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">x</span> <span class="id" title="notation">::</span> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">e</span>)) -?<span class="id" title="var">s_def</span> ?<a class="idref" href="chip.tarjan.html#wf_stack_uniq"><span class="id" title="projection">wf_stack_uniq</span></a> //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mem_head</span> /= ?<span class="id" title="var">s_def</span> <span class="id" title="lemma">take_cat</span> <span class="id" title="lemma">ltnn</span> <span class="id" title="lemma">subnn</span> <span class="id" title="lemma">take0</span> <span class="id" title="lemma">cats0</span>.<br/>
<span class="id" title="var">have</span> <span class="id" title="var">drop_s</span> : <span class="id" title="definition">drop</span> <span class="id" title="notation">(</span><span class="id" title="definition">index</span> <span class="id" title="var">x</span> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">e1</span>)<span class="id" title="notation">).+1</span> (<a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">e1</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">s_def</span> <span class="id" title="lemma">index_cat</span> /= <span class="id" title="abbreviation">eqxx</span> <span class="id" title="lemma">addn0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (@<a class="idref" href="chip.tarjan.html#uniq_catLR"><span class="id" title="lemma">uniq_catLR</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">x</span> <span class="id" title="notation">::</span> <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">e</span>)) -?<span class="id" title="var">s_def</span> ?<a class="idref" href="chip.tarjan.html#wf_stack_uniq"><span class="id" title="projection">wf_stack_uniq</span></a> //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">mem_head</span> /= ?<span class="id" title="var">s_def</span> <span class="id" title="lemma">drop_cat</span> <span class="id" title="lemma">ltnNge</span> <span class="id" title="lemma">leqW</span> //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">subSn</span> // <span class="id" title="lemma">subnn</span> //= <span class="id" title="lemma">drop0</span>.<br/>
<span class="id" title="var">have</span> <span class="id" title="var">g1Nx</span> : <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <span class="id" title="var">e1</span> <span class="id" title="notation">:\</span> <span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#grays"><span class="id" title="definition">grays</span></a> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">keep_gray</span> <a class="idref" href="chip.tarjan.html#grays_add_stack"><span class="id" title="lemma">grays_add_stack</span></a> // <span class="id" title="lemma">setU1K</span> // <a class="idref" href="chip.tarjan.html#whites_graysF"><span class="id" title="lemma">whites_graysF</span></a>.<br/>
<span class="id" title="tactic">split</span>=&gt; //.<br/>
- <span class="id" title="tactic">split</span>=&gt; //.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>: <a class="idref" href="chip.tarjan.html#add_sccs_wf"><span class="id" title="lemma">add_sccs_wf</span></a>=&gt; //; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">take_s</span> //.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">split</span>=&gt; //; <span class="id" title="tactic">rewrite</span> ?<a class="idref" href="chip.tarjan.html#grays_add_sccs"><span class="id" title="lemma">grays_add_sccs</span></a> ?<a class="idref" href="chip.tarjan.html#stack_add_sccs"><span class="id" title="lemma">stack_add_sccs</span></a> ?<span class="id" title="var">take_s</span> ?<span class="id" title="var">drop_s</span>// ?<span class="id" title="var">g1Nx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span>: <a class="idref" href="chip.tarjan.html#wf_grays_to_stack"><span class="id" title="projection">wf_grays_to_stack</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span>: <a class="idref" href="chip.tarjan.html#wf_stack_to_grays"><span class="id" title="projection">wf_stack_to_grays</span></a>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> <a class="idref" href="chip.tarjan.html#whites_add_sccs"><span class="id" title="lemma">whites_add_sccs</span></a> ?<span class="id" title="var">take_s</span> //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; /<span class="id" title="lemma">predU1P</span> [-&gt;|/<span class="id" title="var">Nbw1</span>//]; <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">pred0P</span>=&gt; <span class="id" title="var">z</span> //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2!<span class="id" title="definition">inE</span>; <span class="id" title="var">have</span> /<span class="id" title="lemma">subsetP</span> /(<span class="id" title="var">_</span> <span class="id" title="var">z</span>) := <span class="id" title="var">succ_bVg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> 2!<span class="id" title="definition">inE</span> =&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#implyP"><span class="id" title="lemma">implyP</span></a>; <span class="id" title="tactic">rewrite</span> -<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#negb_imply"><span class="id" title="lemma">negb_imply</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbC"><span class="id" title="lemma">orbC</span></a> =&gt; -&gt;.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#grays_add_sccs"><span class="id" title="lemma">grays_add_sccs</span></a> ?<span class="id" title="var">take_s</span> ?<span class="id" title="var">g1Nx</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#sccs_add_sccs"><span class="id" title="lemma">sccs_add_sccs</span></a> <span class="id" title="var">take_s</span> //=; <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">setP</span>=&gt; <span class="id" title="var">scc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> <a class="idref" href="chip.tarjan.html#blacks_add_sccs"><span class="id" title="lemma">blacks_add_sccs</span></a> ?<span class="id" title="var">take_s</span>//= <span class="id" title="var">black_sccs1</span> !<span class="id" title="definition">inE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">x_s2</span> : <span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="notation">[</span><span class="id" title="notation">set</span> <span class="id" title="var">y</span> <span class="id" title="notation">in</span> <span class="id" title="var">s2</span><span class="id" title="notation">]</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span> <span class="id" title="lemma">mem_rcons</span> <span class="id" title="lemma">mem_head</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">s2_gsccs</span> : <span class="id" title="notation">[</span><span class="id" title="notation">set</span> <span class="id" title="var">y</span> <span class="id" title="notation">in</span> <span class="id" title="definition">rcons</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span><span class="id" title="notation">]</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#gsccs"><span class="id" title="definition">gsccs</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">imsetP</span> =&gt; /=; <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span> =&gt; //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -[<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS"><span class="id" title="abbreviation">RHS</span></a>](@<a class="idref" href="chip.tarjan.html#def_scc"><span class="id" title="definition">def_scc</span></a> <span class="id" title="var">_</span> <span class="id" title="var">x</span>); <span class="id" title="var">last</span> 2 <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">imsetP</span>; <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> ?<span class="id" title="lemma">connect0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">eqP</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">eqEsubset</span> <span class="id" title="var">scc_max</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> [<span class="id" title="var">scc'</span> <span class="id" title="var">scc'_gsccs</span> <span class="id" title="var">sub'</span>] := <a class="idref" href="chip.tarjan.html#is_subscc_in_scc"><span class="id" title="lemma">is_subscc_in_scc</span></a> <span class="id" title="var">sx_subscc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (@<a class="idref" href="chip.tarjan.html#def_scc"><span class="id" title="definition">def_scc</span></a> <span class="id" title="var">scc'</span>) ?<span class="id" title="var">sub'</span> //; <span class="id" title="tactic">apply</span>: (<span class="id" title="lemma">subsetP</span> <span class="id" title="var">sub'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> [<span class="id" title="var">scc_gsccs</span>|] //= := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#boolP"><span class="id" title="lemma">boolP</span></a> (<span class="id" title="var">scc</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <a class="idref" href="chip.tarjan.html#gsccs"><span class="id" title="definition">gsccs</span></a>); <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#contraNF"><span class="id" title="lemma">contraNF</span></a>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbF"><span class="id" title="lemma">orbF</span></a> =&gt; /<span class="id" title="lemma">eqP</span>-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#idP"><span class="id" title="lemma">idP</span></a>/<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#idP"><span class="id" title="lemma">idP</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; /<span class="id" title="lemma">predU1P</span> [-&gt;|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span>/<span class="id" title="lemma">subsetP</span> =&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> <span class="id" title="lemma">mem_rcons</span> <span class="id" title="lemma">in_cons</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">case</span>: <span class="id" title="lemma">eqP</span>=&gt; [-&gt;|] //= <span class="id" title="var">_</span> =&gt; /(<span class="id" title="lemma">subsetP</span> <span class="id" title="var">sb</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; /<span class="id" title="lemma">subset_trans</span>; <span class="id" title="tactic">apply</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">subsetU1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> [<span class="id" title="var">x_scc</span>|<span class="id" title="var">xNscc</span>] := <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#boolP"><span class="id" title="lemma">boolP</span></a> (<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">\</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7"><span class="id" title="notation">in</span></a> <span class="id" title="var">scc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">_</span>; <span class="id" title="tactic">rewrite</span> -(<a class="idref" href="chip.tarjan.html#def_scc"><span class="id" title="definition">def_scc</span></a> <span class="id" title="var">_</span> <span class="id" title="var">x_scc</span>) // (<a class="idref" href="chip.tarjan.html#def_scc"><span class="id" title="definition">def_scc</span></a> <span class="id" title="var">s2_gsccs</span>) ?<span class="id" title="abbreviation">eqxx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="lemma">subDset</span> (<span class="id" title="lemma">setDidPl</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>-&gt;; <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#orbT"><span class="id" title="lemma">orbT</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">disjoint_sym</span> (@<span class="id" title="lemma">eq_disjoint1</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span>) // =&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span>.<br/>
- <span class="id" title="tactic">split</span>=&gt; //.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#stack_add_sccs"><span class="id" title="lemma">stack_add_sccs</span></a> <span class="id" title="var">drop_s</span>; <span class="id" title="tactic">exists</span> <span class="id" title="notation">[::]</span> =&gt; //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">subsetP</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#blacks_add_sccs"><span class="id" title="lemma">blacks_add_sccs</span></a> ?<span class="id" title="var">take_s</span>// (<span class="id" title="lemma">subset_trans</span> <span class="id" title="var">mo_b</span>) ?<span class="id" title="lemma">subsetU1</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#sccs_add_sccs"><span class="id" title="lemma">sccs_add_sccs</span></a> <span class="id" title="var">take_s</span> (<span class="id" title="lemma">subset_trans</span> <span class="id" title="var">mo_sccs</span>) ?<span class="id" title="lemma">subsetU1</span>.<br/>
- <span class="id" title="tactic">split</span>=&gt; //; <span class="id" title="tactic">do</span> ?<span class="id" title="tactic">by</span> [<span class="id" title="tactic">left</span>].<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span> =&gt; /<span class="id" title="lemma">eqP</span>-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#stack_add_sccs"><span class="id" title="lemma">stack_add_sccs</span></a> <span class="id" title="var">drop_s</span> <span class="id" title="lemma">leqNgt</span> <a class="idref" href="chip.tarjan.html#rank_lt"><span class="id" title="lemma">rank_lt</span></a> ?<a class="idref" href="chip.tarjan.html#whites_stackF"><span class="id" title="lemma">whites_stackF</span></a>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span> <a class="idref" href="chip.tarjan.html#stack_add_sccs"><span class="id" title="lemma">stack_add_sccs</span></a> <span class="id" title="var">drop_s</span> =&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a>[<span class="id" title="var">_</span> /<span class="id" title="lemma">existsP</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; [<span class="id" title="var">z</span> /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#and3P"><span class="id" title="lemma">and3P</span></a>[-&gt;]].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a name="tarjan_rec_terminates"><span class="id" title="lemma">tarjan_rec_terminates</span></a> <span class="id" title="var">n</span> (<span class="id" title="var">roots</span> : <span class="id" title="notation">{</span><span class="id" title="notation">set</span> <a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">}</span>) <span class="id" title="var">e</span> :<br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&gt;=</span> <span class="id" title="notation">#|</span><a class="idref" href="chip.tarjan.html#whites"><span class="id" title="definition">whites</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a><span class="id" title="notation">|</span> <span class="id" title="notation">*</span> <span class="id" title="notation">#|</span><a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">|</span><span class="id" title="notation">.+1</span> <span class="id" title="notation">+</span> <span class="id" title="notation">#|</span><a class="idref" href="chip.tarjan.html#roots"><span class="id" title="variable">roots</span></a><span class="id" title="notation">|</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#1c93e43e07fbeaeb6a625cb6614beb5d"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#dfs'_correct"><span class="id" title="definition">dfs'_correct</span></a> (<a class="idref" href="chip.tarjan.html#tarjan_rec"><span class="id" title="definition">tarjan_rec</span></a> <a class="idref" href="chip.tarjan.html#n"><span class="id" title="variable">n</span></a>) <a class="idref" href="chip.tarjan.html#roots"><span class="id" title="variable">roots</span></a> <a class="idref" href="chip.tarjan.html#e"><span class="id" title="variable">e</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">n_ge</span>; <span class="id" title="var">wlog</span> -&gt;: <span class="id" title="var">e</span> <span class="id" title="var">n</span> <span class="id" title="var">roots</span> {<span class="id" title="var">n_ge</span>} / <span class="id" title="var">roots</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">set0</span> =&gt; [<span class="id" title="var">noroot</span>|]; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">have</span> := @<a class="idref" href="chip.tarjan.html#dfs'_is_correct"><span class="id" title="lemma">dfs'_is_correct</span></a> (<a class="idref" href="chip.tarjan.html#dfs1"><span class="id" title="definition">dfs1</span></a> (<a class="idref" href="chip.tarjan.html#tarjan_rec"><span class="id" title="definition">tarjan_rec</span></a> 0)) (<a class="idref" href="chip.tarjan.html#tarjan_rec"><span class="id" title="definition">tarjan_rec</span></a> 0) <span class="id" title="definition">set0</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="chip.tarjan.html#tarjan_rec"><span class="id" title="definition">tarjan_rec</span></a> /<a class="idref" href="chip.tarjan.html#dfs'_correct"><span class="id" title="definition">dfs'_correct</span></a> /<a class="idref" href="chip.tarjan.html#dfs'"><span class="id" title="definition">dfs'</span></a> /=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">case</span>: <span class="id" title="var">n</span>=&gt; [|<span class="id" title="var">n</span> /=]; <span class="id" title="tactic">case</span>: <span class="id" title="lemma">pickP</span> =&gt; [<span class="id" title="var">x</span>|<span class="id" title="var">_</span>/=]; <span class="id" title="tactic">rewrite</span> ?<span class="id" title="definition">inE</span> //;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> =&gt; ?; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span>.<br/>
<span class="id" title="var">have</span> [<span class="id" title="var">V0</span>|<span class="id" title="var">VN0</span>] := <span class="id" title="lemma">posnP</span> <span class="id" title="notation">#|</span><a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">|</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">have</span> := <span class="id" title="lemma">max_card</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#mem"><span class="id" title="definition">mem</span></a> <span class="id" title="var">roots</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">V0</span> <span class="id" title="lemma">leqn0</span> <span class="id" title="lemma">cards_eq0</span> =&gt; /<span class="id" title="lemma">eqP</span> /<span class="id" title="var">noroot</span>; <span class="id" title="tactic">apply</span>.<br/>
<span class="id" title="tactic">elim</span>: <span class="id" title="var">n</span> =&gt; [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">roots</span> <span class="id" title="var">e</span> <span class="id" title="var">n_ge</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">n_ge</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">leqn0</span> <span class="id" title="lemma">addn_eq0</span> <span class="id" title="lemma">cards_eq0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andP"><span class="id" title="lemma">andP</span></a> [<span class="id" title="var">_</span> /<span class="id" title="lemma">eqP</span>/<span class="id" title="var">noroot</span>]; <span class="id" title="tactic">apply</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">pre</span>; <span class="id" title="tactic">rewrite</span> /<a class="idref" href="chip.tarjan.html#dfs'_correct"><span class="id" title="definition">dfs'_correct</span></a> /=.<br/>
<span class="id" title="tactic">apply</span>: <a class="idref" href="chip.tarjan.html#dfs'_is_correct"><span class="id" title="lemma">dfs'_is_correct</span></a> =&gt; //= <span class="id" title="var">x</span> <span class="id" title="var">x_root</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">x_white</span>; <span class="id" title="tactic">apply</span>: <a class="idref" href="chip.tarjan.html#dfs1_is_correct"><span class="id" title="lemma">dfs1_is_correct</span></a> =&gt; //; <span class="id" title="tactic">apply</span>: <span class="id" title="var">IHn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#whites_add_stack"><span class="id" title="lemma">whites_add_stack</span></a> <span class="id" title="lemma">cardsDS</span> ?<span class="id" title="lemma">sub1set</span> // <span class="id" title="lemma">cards1</span> <span class="id" title="lemma">subn1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="lemma">ltnS</span> (<span class="id" title="lemma">leq_trans</span> <span class="id" title="var">_</span> <span class="id" title="var">n_ge</span>) //.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (@<a class="idref" href="chip.tarjan.html#ltn_div2r"><span class="id" title="lemma">ltn_div2r</span></a> <span class="id" title="notation">#|</span><a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">|</span><span class="id" title="notation">.+1</span>) ?<span class="id" title="lemma">divnMDl</span> ?<span class="id" title="lemma">divn_small</span> ?<span class="id" title="lemma">addn0</span> ?<span class="id" title="lemma">ltnS</span> ?<span class="id" title="lemma">max_card</span> //=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">prednK</span> //; <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">card_gt0P</span>; <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>.<br/>
<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">e1</span> <span class="id" title="var">whites_e1</span>; <span class="id" title="tactic">apply</span>: <span class="id" title="var">IHn</span>; <span class="id" title="tactic">rewrite</span> -<span class="id" title="lemma">ltnS</span> (<span class="id" title="lemma">leq_trans</span> <span class="id" title="var">_</span> <span class="id" title="var">n_ge</span>) //.<br/>
<span class="id" title="var">have</span> /<span class="id" title="lemma">subset_leq_card</span> := <span class="id" title="var">whites_e1</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">leq_eqVlt</span> =&gt; /<span class="id" title="lemma">predU1P</span> [-&gt;|<span class="id" title="var">lt_wh</span>]; <span class="id" title="var">last</span> <span class="id" title="tactic">first</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (@<a class="idref" href="chip.tarjan.html#ltn_div2r"><span class="id" title="lemma">ltn_div2r</span></a> <span class="id" title="notation">#|</span><a class="idref" href="chip.tarjan.html#tarjan.V"><span class="id" title="variable">V</span></a><span class="id" title="notation">|</span><span class="id" title="notation">.+1</span>) ?<span class="id" title="lemma">divnMDl</span> ?<span class="id" title="lemma">divn_small</span> ?<span class="id" title="lemma">addn0</span> ?<span class="id" title="lemma">ltnS</span> ?<span class="id" title="lemma">max_card</span>.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">ltn_add2l</span> [<span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">_</span> <span class="id" title="notation">&lt;</span> <a class="idref" href="chip.tarjan.html#X"><span class="id" title="variable">X</span></a>](<span class="id" title="lemma">cardsD1</span> <span class="id" title="var">x</span>) <span class="id" title="var">x_root</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="tarjan_rec_is_correct"><span class="id" title="lemma">tarjan_rec_is_correct</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="chip.tarjan.html#tarjan_rec"><span class="id" title="definition">tarjan_rec</span></a> <a class="idref" href="chip.tarjan.html#tarjan.N"><span class="id" title="variable">N</span></a> <span class="id" title="abbreviation">setT</span> <a class="idref" href="chip.tarjan.html#e0"><span class="id" title="definition">e0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="chip.tarjan.html#infty"><span class="id" title="abbreviation">infty</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="chip.tarjan.html#Env"><span class="id" title="constructor">Env</span></a> <span class="id" title="abbreviation">setT</span> <span class="id" title="notation">[::]</span> <a class="idref" href="chip.tarjan.html#gsccs"><span class="id" title="definition">gsccs</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="var">have</span> := @<a class="idref" href="chip.tarjan.html#tarjan_rec_terminates"><span class="id" title="lemma">tarjan_rec_terminates</span></a> <a class="idref" href="chip.tarjan.html#tarjan.N"><span class="id" title="variable">N</span></a> <span class="id" title="abbreviation">setT</span> <a class="idref" href="chip.tarjan.html#e0"><span class="id" title="definition">e0</span></a>; <span class="id" title="tactic">rewrite</span> /<a class="idref" href="chip.tarjan.html#dfs'_correct"><span class="id" title="definition">dfs'_correct</span></a>.<br/>
<span class="id" title="tactic">case</span>: <a class="idref" href="chip.tarjan.html#tarjan_rec"><span class="id" title="definition">tarjan_rec</span></a> =&gt; [<span class="id" title="var">m</span> <span class="id" title="var">e</span>] [].<br/>
- <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> ?<span class="id" title="lemma">leq_add</span> ?<span class="id" title="lemma">leq_mul</span> ?<span class="id" title="lemma">max_card</span>.<br/>
- <span class="id" title="tactic">split</span>=&gt; //.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">x</span>; <span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#grays0"><span class="id" title="lemma">grays0</span></a> <span class="id" title="definition">inE</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">by</span> <span class="id" title="tactic">split</span>=&gt; //; <span class="id" title="tactic">rewrite</span> /= ?<a class="idref" href="chip.tarjan.html#cover0"><span class="id" title="lemma">cover0</span></a> ?<a class="idref" href="chip.tarjan.html#grays0"><span class="id" title="lemma">grays0</span></a> ?<span class="id" title="lemma">set0D</span> ?<span class="id" title="lemma">setU0</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">by</span> <span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">x</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="definition">inE</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">setP</span>=&gt; <span class="id" title="var">y</span>; <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> /= <span class="id" title="lemma">subset0</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andbC"><span class="id" title="lemma">andbC</span></a>; <span class="id" title="tactic">case</span>: <span class="id" title="lemma">eqP</span> =&gt; //= -&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">have</span> /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#and3P"><span class="id" title="lemma">and3P</span></a> [<span class="id" title="var">_</span> <span class="id" title="var">_</span> /<a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#negPf"><span class="id" title="lemma">negPf</span></a>-&gt;]:= <a class="idref" href="chip.tarjan.html#gsccs_partition"><span class="id" title="lemma">gsccs_partition</span></a>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">subTset</span> =&gt; /<span class="id" title="lemma">eqP</span> <span class="id" title="var">blackse</span> [[[<span class="id" title="var">stack_wf</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>] <span class="id" title="var">_</span> <span class="id" title="var">_</span>]].<br/>
<span class="id" title="tactic">rewrite</span> <a class="idref" href="chip.tarjan.html#grays0"><span class="id" title="lemma">grays0</span></a> =&gt; <span class="id" title="var">grayse</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">grayse</span> <span class="id" title="lemma">setU0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">blackse</span>.<br/>
<span class="id" title="tactic">rewrite</span> /<a class="idref" href="chip.tarjan.html#black_gsccs"><span class="id" title="definition">black_gsccs</span></a> /= <span class="id" title="var">blackse</span> =&gt; <span class="id" title="var">sccse</span> <span class="id" title="var">_</span> [<span class="id" title="var">_</span> <span class="id" title="var">minfty</span> <span class="id" title="var">_</span>].<br/>
<span class="id" title="var">have</span> {<span class="id" title="var">sccse</span>}<span class="id" title="var">sccse</span>: <a class="idref" href="chip.tarjan.html#sccs"><span class="id" title="projection">sccs</span></a> <span class="id" title="var">e</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#gsccs"><span class="id" title="definition">gsccs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>/<span class="id" title="lemma">setP</span>=&gt; <span class="id" title="var">scc</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">sccse</span> <span class="id" title="definition">inE</span> <span class="id" title="lemma">subsetT</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.ssr.ssrbool.html#andbT"><span class="id" title="lemma">andbT</span></a>.<br/>
<span class="id" title="var">have</span> <span class="id" title="var">stacke</span> : <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> <span class="id" title="var">e</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">[::]</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">have</span> := <span class="id" title="var">stack_wf</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">grayse</span> <span class="id" title="var">blackse</span> <span class="id" title="var">sccse</span> <a class="idref" href="chip.tarjan.html#cover_gsccs"><span class="id" title="definition">cover_gsccs</span></a> <span class="id" title="lemma">set0U</span> <span class="id" title="lemma">setDv</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">case</span>: <a class="idref" href="chip.tarjan.html#stack"><span class="id" title="projection">stack</span></a> =&gt; // <span class="id" title="var">x</span> <span class="id" title="var">s</span> /<span class="id" title="lemma">setP</span> /(<span class="id" title="var">_</span> <span class="id" title="var">x</span>); <span class="id" title="tactic">rewrite</span> !<span class="id" title="definition">inE</span> <span class="id" title="abbreviation">eqxx</span>.<br/>
<span class="id" title="var">congr</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">case</span>: <span class="id" title="var">minfty</span> =&gt; // [[<span class="id" title="var">x</span> <span class="id" title="var">_</span> [<span class="id" title="var">y</span> <span class="id" title="var">xy</span>]]]; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">stacke</span>.<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">case</span>: <span class="id" title="var">e</span> <span class="id" title="var">blackse</span> <span class="id" title="var">sccse</span> <span class="id" title="var">stacke</span> {<span class="id" title="var">stack_wf</span> <span class="id" title="var">grayse</span> <span class="id" title="var">minfty</span>} =&gt; //= *; <span class="id" title="var">congr</span> <a class="idref" href="chip.tarjan.html#Env"><span class="id" title="constructor">Env</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a name="tarjan_correct"><span class="id" title="lemma">tarjan_correct</span></a> : <a class="idref" href="chip.tarjan.html#tarjan"><span class="id" title="definition">tarjan</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.9.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="chip.tarjan.html#gsccs"><span class="id" title="definition">gsccs</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> /<a class="idref" href="chip.tarjan.html#tarjan"><span class="id" title="definition">tarjan</span></a> <a class="idref" href="chip.tarjan.html#tarjan_rec_is_correct"><span class="id" title="lemma">tarjan_rec_is_correct</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="chip.tarjan.html#tarjan"><span class="id" title="section">tarjan</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr">coqdoc</a> and improved with <a href="https://github.com/palmskog/coqdocjs">CoqdocJS</a> as adapted for <a href="https://github.com/coq-community">coq-community</a>
</div>
</div>
</body>

</html>
